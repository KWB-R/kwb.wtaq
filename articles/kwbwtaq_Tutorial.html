<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial for R package kwb.wtaq • kwb.wtaq</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial for R package kwb.wtaq">
<meta property="og:description" content="kwb.wtaq">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.wtaq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/kwbwtaq_ParameterTable.html">Parameters of configuration functions in kwb.wtaq</a>
    </li>
    <li>
      <a href="../articles/kwbwtaq_Tutorial.html">Tutorial for R package kwb.wtaq</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KWB-R/kwb.wtaq/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="kwbwtaq_Tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial for R package kwb.wtaq</h1>
                        <h4 data-toc-skip class="author">Hauke Sonnenberg &amp; Michael Rustler (Kompetenzzentrum Wasser Berlin gGmbH)</h4>
            
            <h4 data-toc-skip class="date">June 11, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.wtaq/blob/HEAD/vignettes/kwbwtaq_Tutorial.Rmd" class="external-link"><code>vignettes/kwbwtaq_Tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>kwbwtaq_Tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>Background</strong></p>
<p>Within the OPTIWELLS-2 project, sponsored by Veolia Water, a detailed study was performed for screening available models that:</p>
<ul>
<li><p>are able to simulate time-dependent well drawdown</p></li>
<li><p>also include the additional drawdown in case of well interference and</p></li>
<li><p>are quite easy to parameterise</p></li>
</ul>
<p>The semi-analytical groundwater model WTAQ-2 was chosen, because it fitted best with the above defined requirements. However, as the model is programmed in FORTRAN it requires that the user follows the steps that are listed below:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Step: Definition and parameterisation of text input file,</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Step: Execution of the WTAQ-2 model engine in MS DOS command shell</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Step: Saving of model results in a text output file</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Step: Reading and analysing of model outputs</li>
</ol></li>
<li><ol start="5" style="list-style-type: decimal">
<li>Step (in case of well interference): looping through Steps 1-4 for each active production well and superposition of additional drawdowns due to well interference</li>
</ol></li>
</ul>
<p>For simplifying this process it was decided to build an R package that enables to perform all these steps and also includes the WTAQ-2 model engine (for more details see: <a href="https://doi.org/10.13140/RG.2.1.2140.3683" class="external-link">Sonnenberg et al., 2014</a>). This R package <em>kwb.wtaq</em> was developed by Hauke Sonnenberg at Kompetenzzentrum Wasser Berlin (KWB). It provides an Application Programming Interface (API) to the analytical groundwater drawdown model WTAQ-2, developed by the United States Geological Survey (USGS) and provided for free (for further information on WTAQ-2 see: <a href="http://water.usgs.gov/ogw/wtaq/" class="external-link uri">http://water.usgs.gov/ogw/wtaq/</a>). In the following we will simply use “WTAQ” when referring to the software WTAQ-2.</p>
<p><strong>Objective</strong></p>
<p>The objective of this tutorial is to demonstrate how the functions from the R-package <em>kwb.wtaq</em> can be used to configure and run a WTAQ model setup and to read the resulting groundwater drawdowns from the output files that are generated by the WTAQ model software.</p>
<div class="section level3">
<h3 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h3>
<p>In order to use the R package you need to have the <strong>R programming environment (in version 3.0 or higher)</strong> installed on your computer. You can download it for free from <a href="http://cran.rstudio.com/" class="external-link uri">http://cran.rstudio.com/</a>.</p>
<p>As Integrated Programming Interface (IDE) for the R environment we recommend — and for the purpose of this tutorial require — to use the free software <strong>RStudio</strong>. You can download RStudio from: <a href="http://www.rstudio.com/products/rstudio/download/" class="external-link uri">http://www.rstudio.com/products/rstudio/download/</a>.</p>
<p>The programming environment R is shipped with a basic set of functions. It can be extended by so-called packages that contain user-defined functions. We used this packaging mechanism and provide the access functions to WTAQ in the form of an R package that we named <em>kwb.wtaq</em>.</p>
<p>Before you can start using the functions provided in the package you need to</p>
<ol style="list-style-type: decimal">
<li><p>Install the package into your R programming environment and</p></li>
<li><p>Load the package into your current R session.</p></li>
</ol>
<div class="section level4">
<h4 id="installation-of-required-r-packages">Installation of required R packages<a class="anchor" aria-label="anchor" href="#installation-of-required-r-packages"></a>
</h4>
<p>Since the package <em>kwb.wtaq</em> depends on a number of other packages, not only <em>kwb.wtaq</em> but also all the packages that it depends on need to be installed.</p>
<p>In order to simplify the package installation run the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="op">}</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"KWB-R/kwb.wtaq"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>This will download and install the package <strong><a href="https://github.com/KWB-R/kwb.wtaq" class="external-link">kwb.wtaq</a></strong> with all required dependencies, i.e.:</p>
<ul>
<li><p>publicly available packages from the Comprehensive R Archive Network (CRAN) and</p></li>
<li><p>the KWB Github package <a href="https://github.com/KWB-R/kwb.utils" class="external-link">kwb.utils</a></p></li>
</ul>
<p>If the installation succeeds the messages generated should read like these:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## package 'zoo' successfully unpacked and MD5 sums checked</span>
<span class="co">## package 'hydroGOF' successfully unpacked and MD5 sums checked</span>
<span class="co">## package 'lattice' successfully unpacked and MD5 sums checked</span>
<span class="co">## package 'plotrix' successfully unpacked and MD5 sums checked</span>
<span class="co">## </span>
<span class="co">## The downloaded binary packages are in</span>
<span class="co">##  C:\Dokumente und Einstellungen\Key Hauke\Lokale Einstellungen\Temp\RtmpctBYMz\downloaded_packages</span>
<span class="co">## package 'kwb.utils' successfully unpacked and MD5 sums checked</span></code></pre></div>
<p>The installation needs to be done only once. The packages keep installed until you decide to uninstall them. Uninstalling a package in RStudio can be done by clicking on the <code>Remove package</code> button right to the package name on the “Packages” tab.</p>
</div>
<div class="section level4">
<h4 id="loading-the-package">Loading the package<a class="anchor" aria-label="anchor" href="#loading-the-package"></a>
</h4>
<p>Once you have installed all the requied packages you are almost ready to use the functions contained in the package <em>kwb.wtaq</em>.</p>
<p>As a last step you need to explicitly load the package into your current R session by running the following R command:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KWB-R/kwb.wtaq" class="external-link">kwb.wtaq</a></span><span class="op">)</span></code></pre></div>
<p>You will see messages stating the progress of loading not only the package <em>kwb.wtaq</em> but also of all the packages that it depends on.</p>
<p>You may see warnings that the packages have been built under R in a higher version compared to the version that you are using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Warning: package 'kwb.utils' was built under R version 3.0.3</span></code></pre></div>
<p>Unless you are using R in a version prior to 3.0 these messages do not indicate a problem and can be ignored.</p>
<p>Please note that the functions provided in the <em>kwb.wtaq</em> package can only be used when the package is loaded with <code><a href="https://github.com/KWB-R/kwb.wtaq" class="external-link">library(kwb.wtaq)</a></code> as shown here. This needs to be done each time you start a new R session or each time you open RStudio. If you write an R script that uses the functions from <em>kwb.wtaq</em> then it would be a good practice to put <code><a href="https://github.com/KWB-R/kwb.wtaq" class="external-link">library(kwb.wtaq)</a></code> as one of the first lines of your script.</p>
</div>
</div>
<div class="section level3">
<h3 id="using-the-package-help">Using the package help<a class="anchor" aria-label="anchor" href="#using-the-package-help"></a>
</h3>
<p>A detailed description of the WTAQ model parameters is available in the <a href="http://pubs.usgs.gov/tm/tm3b9/pdf/tm3-b9_barlow_wtaqv2_report.pdf" class="external-link">WTAQ documentation</a>. However, within ‘RStudio’ is not always necessary to consult this manual, because the parameter description is integrated in the <strong>kwb.wtaq</strong> package help. These information can be accessed by pressing <code>Ctrl</code> and <code>Space</code> simultaneously, if the cursor is located within a function, e.g. <code>wtConfGeneral()</code>:</p>
<div class="figure">
<img src="pictures/ontheflyhelp.jpg" alt=""><p class="caption">On the fly help in RStudio</p>
</div>
<p>The help file for each R function in <code>RStudio</code> can be accessed by using the R command <code>help(functionname)</code> or using <code>?</code> before the functionname, e.g.:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="fu">kwb.wtaq</span><span class="fu">::</span><span class="va"><a href="../reference/wtConfigure.html">wtConfigure</a></span>
<span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="fu">kwb.wtaq</span><span class="fu">::</span><span class="va"><a href="../reference/wtConfigure.html">wtConfigure</a></span><span class="op">)</span></code></pre></div>
<p><strong>Note:</strong> <em>Typing <code>kwb.wtaq::</code> before the function name is only needed if you haven’t loaded the package into your R session with <code><a href="https://github.com/KWB-R/kwb.wtaq" class="external-link">library(kwb.wtaq)</a></code> (see <a href="#loading-the-package">Loading the package</a>)</em></p>
<p>In addition, we also provide a <a href="kwbwtaq_ParameterTable.html">full description</a> of all the parameters that are accepted by the configuration functions, which are descriped later in this tutorial.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-sessions">Example sessions<a class="anchor" aria-label="anchor" href="#example-sessions"></a>
</h2>
<div class="section level3">
<h3 id="level-1-one-pumping-well">Level 1: One pumping well<a class="anchor" aria-label="anchor" href="#level-1-one-pumping-well"></a>
</h3>
<div class="section level4">
<h4 id="pumping-test-data">Pumping test data<a class="anchor" aria-label="anchor" href="#pumping-test-data"></a>
</h4>
<p>We have provided an example dataset “drawdowns” containing four different pumping tests with measured drawdown time-series in five different wells (production well and four observation wells). You can load the dataset by running:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"drawdowns"</span>, package <span class="op">=</span> <span class="st">"kwb.wtaq"</span><span class="op">)</span></code></pre></div>
<p>Let’s have a short look to the dataset. It is a list of four data frames as the R command “str” reveals:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">drawdowns</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 4</span>
<span class="co">##  $ W1:'data.frame':  15 obs. of  6 variables:</span>
<span class="co">##   ..$ time.in.seconds: num [1:15] 420 1020 1620 2820 4020 ...</span>
<span class="co">##   ..$ W1             : num [1:15] 1.25 1.42 1.46 1.52 1.56 ...</span>
<span class="co">##   ..$ W2             : num [1:15] 0.02 0.04 0.05 0.07 0.08 ...</span>
<span class="co">##   ..$ W3             : num [1:15] 0 0.01 0.01 0.02 0.03 ...</span>
<span class="co">##   ..$ W4             : num [1:15] 0 0 0.01 0.02 0.02 ...</span>
<span class="co">##   ..$ W5             : num [1:15] 0 0.01 0.01 0.01 0.01 ...</span>
<span class="co">##  $ W2:'data.frame':  15 obs. of  6 variables:</span>
<span class="co">##   ..$ time.in.seconds: num [1:15] 120 720 1320 2520 3720 ...</span>
<span class="co">##   ..$ W2             : num [1:15] 1.2 1.73 1.62 1.68 1.75 ...</span>
<span class="co">##   ..$ W1             : num [1:15] 0.01 0.05 0.06 0.09 0.1 ...</span>
<span class="co">##   ..$ W3             : num [1:15] 0 0.02 0.03 0.05 0.06 ...</span>
<span class="co">##   ..$ W4             : num [1:15] 0 0 0.01 0.01 0.02 ...</span>
<span class="co">##   ..$ W5             : num [1:15] 0 0.01 0.01 0.01 0.01 ...</span>
<span class="co">##  $ W4:'data.frame':  15 obs. of  6 variables:</span>
<span class="co">##   ..$ time.in.seconds: num [1:15] 60 660 1260 2460 3660 ...</span>
<span class="co">##   ..$ W4             : num [1:15] 0.5 0.76 0.79 0.82 0.84 ...</span>
<span class="co">##   ..$ W1             : num [1:15] 0 0 0.01 0.02 0.02 ...</span>
<span class="co">##   ..$ W2             : num [1:15] 0.01 0.01 0.01 0.02 0.03 ...</span>
<span class="co">##   ..$ W3             : num [1:15] 0.01 0.05 0.06 0.08 0.1 ...</span>
<span class="co">##   ..$ W5             : num [1:15] 0.01 0.04 0.05 0.07 0.08 ...</span>
<span class="co">##  $ W5:'data.frame':  15 obs. of  6 variables:</span>
<span class="co">##   ..$ time.in.seconds: num [1:15] 600 1200 1800 2400 3600 5400 7200 10800 15000 21600 ...</span>
<span class="co">##   ..$ W5             : num [1:15] 0.73 0.74 0.75 0.77 0.78 ...</span>
<span class="co">##   ..$ W1             : num [1:15] 0 0 0 0.01 0.01 ...</span>
<span class="co">##   ..$ W2             : num [1:15] 0 0 0 0 0 ...</span>
<span class="co">##   ..$ W3             : num [1:15] 0.01 0.01 0.01 0.01 0.02 ...</span>
<span class="co">##   ..$ W4             : num [1:15] 0.04 0.04 0.06 0.06 0.07 ...</span></code></pre>
<p>The four list elements represent four different pumping tests (in “W1”, “W2”, “W4” and “W5”. The resulting drawdowns of each pumping test are stored in a data frame of six columns. Column “time.in.seconds” contains the time in seconds since the start of a pumping test. The columns “W1” through “W5” contain the water table drawdowns measured in the corresponding wells “W1” to “W5”,in meters below the initial water table.</p>
<p>For example, the fourth pumping test, during which a discharge of Q = 313 m3/h was measured in Well W5, resulted in the following drawdowns:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">drawdowns</span><span class="op">[[</span><span class="st">"W5"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">##    time.in.seconds   W5   W1   W2   W3   W4</span>
<span class="co">## 1              600 0.73 0.00 0.00 0.01 0.04</span>
<span class="co">## 2             1200 0.74 0.00 0.00 0.01 0.04</span>
<span class="co">## 3             1800 0.75 0.00 0.00 0.01 0.06</span>
<span class="co">## 4             2400 0.77 0.01 0.00 0.01 0.06</span>
<span class="co">## 5             3600 0.78 0.01 0.00 0.02 0.07</span>
<span class="co">## 6             5400 0.80 0.01 0.01 0.03 0.09</span>
<span class="co">## 7             7200 0.82 0.02 0.01 0.04 0.10</span>
<span class="co">## 8            10800 0.83 0.03 0.02 0.05 0.11</span>
<span class="co">## 9            15000 0.85 0.03 0.03 0.06 0.13</span>
<span class="co">## 10           21600 0.87 0.04 0.04 0.08 0.15</span>
<span class="co">## 11           31200 0.89 0.05 0.05 0.09 0.16</span>
<span class="co">## 12           44400 0.92 0.06 0.06 0.11 0.18</span>
<span class="co">## 13           63600 0.93 0.07 0.07 0.12 0.20</span>
<span class="co">## 14           90600 0.95 0.08 0.08 0.14 0.21</span>
<span class="co">## 15          129600 0.96 0.09 0.09 0.15 0.23</span></code></pre>
<p>It seems as if the drawdowns reach a steady-state after a certain time. This can be judged better by a diagram that can be produced in R by using the xyplot function from the R-package “lattice”:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">W1</span> <span class="op">+</span> <span class="va">W2</span> <span class="op">+</span> <span class="va">W3</span> <span class="op">+</span> <span class="va">W4</span> <span class="op">+</span> <span class="va">W5</span> <span class="op">~</span> <span class="va">time.in.seconds</span>, 
       data <span class="op">=</span> <span class="va">drawdowns</span><span class="op">[[</span><span class="st">"W5"</span><span class="op">]</span><span class="op">]</span>, 
       type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"g"</span><span class="op">)</span>, <span class="co"># (b)oth, dots and lines, and a (g)rid</span>
       auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="co"># legend arranged in five columns</span>
       ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>,
       ylab<span class="op">=</span> <span class="st">"Drawdown (m)"</span>, <span class="co"># label of y-Axis</span>
       xlab<span class="op">=</span> <span class="st">"Time in seconds since start of pumping in W5 (s)"</span><span class="op">)</span> <span class="co"># label of y-Axis</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="model-parameterisation">Model parameterisation<a class="anchor" aria-label="anchor" href="#model-parameterisation"></a>
</h4>
<p>In a first step a WTAQ input file needs to be defined. This can be realised with two different functions:</p>
<ul>
<li><p><code><a href="../reference/wtConfigure.html">wtConfigure()</a></code>: definition of WTAQ configuration within R</p></li>
<li><p><code><a href="../reference/wtReadInputFile.html">wtReadInputFile()</a></code>: importing of WTAQ configuration from existing WTAQ input text file into R</p></li>
</ul>
<p>The WTAQ input file can be directly defined in R using the function <code><a href="../reference/wtConfigure.html">wtConfigure()</a></code> and saved in the R object <code>wtaqConfiguration</code> (for a full description of all the parameters that are accepted by the configuration functions, see: <a href="kwbwtaq_ParameterTable.html">Parameter tables</a>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">generalConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureGeneral.html">wtConfigureGeneral</a></span><span class="op">(</span>
  <span class="co">### title of the project (max. length 70 characters)</span>
  title<span class="op">=</span><span class="st">"Example well field, long-term pumping test of well 5"</span>
  <span class="op">)</span>

<span class="va">aquiferConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureAquifer.html">wtConfigureAquifer</a></span><span class="op">(</span>    
  aqtype <span class="op">=</span> <span class="st">"WATER TABLE"</span>, <span class="co"># aquifer type</span>
  bb <span class="op">=</span> <span class="fl">10</span>,                <span class="co"># saturated aquifer thickness</span>
  hkr <span class="op">=</span> <span class="fl">1E-03</span>,            <span class="co"># horizontal hydraulic conductivity</span>
  hkz <span class="op">=</span> <span class="fl">3.5E-05</span>,          <span class="co"># vertical hydraulic conductivity</span>
  ss <span class="op">=</span> <span class="fl">1E-05</span>,             <span class="co"># specific storage</span>
  sy <span class="op">=</span> <span class="fl">0.05</span>               <span class="co"># specific yield</span>
<span class="op">)</span>

<span class="va">drainageConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureDrainage.html">wtConfigureDrainage</a></span><span class="op">(</span>
  idra <span class="op">=</span> <span class="fl">0</span> <span class="co"># = instantaneous drainage in unsaturated zone</span>
<span class="op">)</span>

<span class="va">timesConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureTimes.html">wtConfigureTimes</a></span><span class="op">(</span>
  its <span class="op">=</span> <span class="fl">1</span> <span class="co"># = user-specified time-steps</span>
<span class="op">)</span></code></pre></div>
<p>In the following we will configure one pumping well and two observation wells (for simplifying the tutorial we restrict ourselves to two instead of four observation wells four which drawdown time series are available).</p>
<p>Since WTAQ allows to define time-series of measured drawdowns for each well, the corresponding functions <code><a href="../reference/wtConfigurePumpwell.html">wtConfigurePumpwell()</a></code> and <code><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell()</a></code>, that are described in the following, also allow to specify these measured drawdown values. For this example, we want to use the drawdowns of the fourth pumping test, provided in the example dataset <code>drawdowns</code>. We store it in a separate variable <code>drawdowns5</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">drawdowns5</span> <span class="op">&lt;-</span> <span class="va">drawdowns</span><span class="op">[[</span><span class="st">"W5"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p>Now we prepare some data frames (a table-like structure in R, defined by rows and columns, see <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">?data.frame</a></code>) representing three drawdown time series, which are measured at :</p>
<ul>
<li><p>the pumping well “PW” and</p></li>
<li><p>two different observation wells “OW1” and “OW4”.</p></li>
</ul>
<p>By doing this we simplify the programmig code that is used later on:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the times of observations are the same for all wells:</span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="va">drawdowns5</span><span class="op">$</span><span class="va">time.in.seconds</span>

<span class="co"># observed drawdowns at the pumping well</span>
<span class="va">observed.PW</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">times</span>, dd <span class="op">=</span> <span class="va">drawdowns5</span><span class="op">$</span><span class="va">W5</span><span class="op">)</span>

<span class="co"># observed drawdowns at the observation wells</span>
<span class="va">observed.OW1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">times</span>, dd <span class="op">=</span> <span class="va">drawdowns5</span><span class="op">$</span><span class="va">W1</span><span class="op">)</span>
<span class="va">observed.OW4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">times</span>, dd <span class="op">=</span> <span class="va">drawdowns5</span><span class="op">$</span><span class="va">W4</span><span class="op">)</span></code></pre></div>
<p>Let’s start with the configuration of the pumping well:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pumpwellConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigurePumpwell.html">wtConfigurePumpwell</a></span><span class="op">(</span>
  <span class="co">### partially penetrating pumped well</span>
  ipws <span class="op">=</span> <span class="fl">0</span>,
  <span class="co">### finite diameter well</span>
  ipwd <span class="op">=</span> <span class="fl">1</span>, 
  <span class="co">### pumping rate of production well in (here: m3/s)</span>
  qq <span class="op">=</span> <span class="fl">0.0869</span>, 
  <span class="co">### radius of pumped well-screen (here: meter) </span>
  rw <span class="op">=</span> <span class="fl">1.5</span>, 
  <span class="co">### top of filter screen below initial water table (here: meter)</span>
  zpd <span class="op">=</span> <span class="fl">0.4</span>, 
  <span class="co">### bottom of filter screen below initial water table (here: meter)</span>
  zpl <span class="op">=</span> <span class="fl">7.8</span>, 
  <span class="co">### well-bore skin parameter (dimensionless)</span>
  sw <span class="op">=</span> <span class="fl">0</span>, 
  <span class="co">### data.frame with times and measured drawdown data in pumping well</span>
  tspw <span class="op">=</span> <span class="va">observed.PW</span> 
<span class="op">)</span></code></pre></div>
<p>Now, let’s define our first observation well:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">observationWell1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell</a></span><span class="op">(</span>
  <span class="co">### name of observation well</span>
  obname <span class="op">=</span> <span class="st">"OW1"</span>, 
  <span class="co">### distance from pumping well (here: meters)</span>
  r <span class="op">=</span> <span class="fl">309.5</span>, 
  <span class="co">### partially penetrating observation well</span>
  iows <span class="op">=</span> <span class="fl">0</span>, 
  <span class="co">### delayed response</span>
  idpr <span class="op">=</span> <span class="fl">1</span>, 
  <span class="co">### top of filter screen below initial water table (here: meters)</span>
  z1 <span class="op">=</span> <span class="fl">1.8</span>, 
  <span class="co">### bottom of filter screen below initial water table (here: meters)</span>
  z2 <span class="op">=</span> <span class="fl">7.5</span>, 
  <span class="co">### inside radius of the observation well (here: meters)</span>
  rp <span class="op">=</span> <span class="fl">1.5</span>, 
  <span class="co">### data.frame with times and measured drawdown data in OW1</span>
  tsobs<span class="op">=</span> <span class="va">observed.OW1</span> 
<span class="op">)</span></code></pre></div>
<p>In the same way, we define a second observation well “OW4” (in a formally more compact way to save some space here):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">observationWell4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell</a></span><span class="op">(</span>obname <span class="op">=</span> <span class="st">"OW4"</span>, r <span class="op">=</span> <span class="fl">86.6</span>,
  iows <span class="op">=</span> <span class="fl">0</span>, idpr <span class="op">=</span> <span class="fl">1</span>, z1 <span class="op">=</span> <span class="fl">1.8</span>, z2 <span class="op">=</span> <span class="fl">7.5</span>, rp <span class="op">=</span> <span class="fl">1.5</span>, tsobs <span class="op">=</span> <span class="va">observed.OW4</span><span class="op">)</span></code></pre></div>
<p>Out of these parts of configuration we can build one complete configuration by using the function <code><a href="../reference/wtConfigure.html">wtConfigure()</a></code>. It returns a R list structure that represents a model configuration containing all the necessary information that WTAQ requires to perform a model run. This information is saved in the R object <code>wtaqConfiguration</code> and will be used for the following chapters of this tutorial.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wtaqConfiguration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtConfigure.html">wtConfigure</a></span><span class="op">(</span>
  general <span class="op">=</span> <span class="va">generalConfiguration</span>,
  aquifer <span class="op">=</span> <span class="va">aquiferConfiguration</span>, 
  drainage <span class="op">=</span> <span class="va">drainageConfiguration</span>, 
  times <span class="op">=</span> <span class="va">timesConfiguration</span>, 
  solution <span class="op">=</span> <span class="fu"><a href="../reference/wtConfigureSolution.html">wtConfigureSolution</a></span><span class="op">(</span><span class="op">)</span>,
  pumpwell <span class="op">=</span> <span class="va">pumpwellConfiguration</span>,
  obswells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">observationWell4</span>, 
                  <span class="va">observationWell1</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><strong>Note:</strong> <em>Alternatively it is possible to load WTAQ input text files diretly into R with the function <code><a href="../reference/wtReadInputFile.html">wtReadInputFile()</a></code> from an already existing WTAQ input text file, e.g.:</em></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inputFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example1.inp"</span>, package <span class="op">=</span> <span class="st">"kwb.wtaq"</span><span class="op">)</span>
<span class="va">wtaqConfiguration2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtReadInputFile.html">wtReadInputFile</a></span><span class="op">(</span><span class="va">inputFile</span><span class="op">)</span></code></pre></div>
<p><em>However, in this tutorial we just focus on the example that is stored in the R object <code>wtaqConfiguration</code>.</em></p>
<p>For checking this model parameterisation it can be printed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wtaqConfiguration</span></code></pre></div>
<pre><code><span class="co">## General</span>
<span class="co">## - Title:  Example well field, long-term pumping test of well 5 </span>
<span class="co">## - Format: DIMENSIONAL </span>
<span class="co">## </span>
<span class="co">## Aquifer</span>
<span class="co">## - Type: WATER TABLE </span>
<span class="co">## - Thickness (bb) ............: 10.000000 (length)</span>
<span class="co">## - Horiz. hydr. conduct. (hkr): 0.001000 (length/time)</span>
<span class="co">## - Vert.  hydr. conduct. (hkz): 0.000035 (length/time)</span>
<span class="co">## - Specific storage (ss) .....: 0.000010 (1/length)</span>
<span class="co">## - Specific yield (sy) .......: 0.050000</span>
<span class="co">## </span>
<span class="co">## Drainage</span>
<span class="co">## - Type: Instantaneous drainage (idra = 0)</span>
<span class="co">## </span>
<span class="co">## Times</span>
<span class="co">## - Type: User-specified times (its = 1)</span>
<span class="co">## </span>
<span class="co">## Solution</span>
<span class="co">## - Type: de Hoog algorithm (isoln = 2)</span>
<span class="co">## - Rel. err. for Newton-Raphson iter. (rerrnr) ...................: 0.000000</span>
<span class="co">## - Rel. err. sought for accur. of the num. invers. (error) .......: 0.000100</span>
<span class="co">## - Factor to determ. # terms in finite summations (ntms) .........: 30</span>
<span class="co">## - # terms in summ. of Fourier series for inv. Lapl. transf. (nnn): 6</span>
<span class="co">## - Method used to accelerate convergence of Fourier series .......: 3</span>
<span class="co">## </span>
<span class="co">## Pumped Well ("PW")</span>
<span class="co">## - Type: Partially penetrating pumped well (ipws = 0)</span>
<span class="co">## - Type of diameter: Finite diameter (ipwd = 1)</span>
<span class="co">## - Pumping rate (qq) .......................................: 0.086900 (length^3/time)</span>
<span class="co">## - Radius of screen (rw) ...................................: 1.500000 (length)</span>
<span class="co">## - Inside radius where levels change during pumping (rc) ...: 1.500000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen top (zpd) ..: 0.400000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen bottom (zpl): 7.800000 (length)</span>
<span class="co">## - Well-bore skin parameter (sw) ...........................: 0.000000 </span>
<span class="co">## - Predefined Times (t)/drawdown measurements (dd):</span>
<span class="co">##         t   dd</span>
<span class="co">## 1     600 0.73</span>
<span class="co">## 2    1200 0.74</span>
<span class="co">## 3    1800 0.75</span>
<span class="co">## 4    2400 0.77</span>
<span class="co">## 5    3600 0.78</span>
<span class="co">## 6    5400 0.80</span>
<span class="co">## 7    7200 0.82</span>
<span class="co">## 8   10800 0.83</span>
<span class="co">## 9   15000 0.85</span>
<span class="co">## 10  21600 0.87</span>
<span class="co">## 11  31200 0.89</span>
<span class="co">## 12  44400 0.92</span>
<span class="co">## 13  63600 0.93</span>
<span class="co">## 14  90600 0.95</span>
<span class="co">## 15 129600 0.96</span>
<span class="co">## </span>
<span class="co">## Observation Well "OW4"</span>
<span class="co">## - Type: Partially penetrating observation well (iows = 0)</span>
<span class="co">## - Delayed response: yes (idpr = 1)</span>
<span class="co">## - Radial dist. from axis of pumped well to obs. well (r) .....: 86.600000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen top (z1) ......: 1.800000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen bottom (z2) ...: 7.500000 (length)</span>
<span class="co">## - Inside radius of standpipe where levels change (rp) ........: 1.500000 (length)</span>
<span class="co">## - Length of screened interval (xll) ..........................: 5.700000 (length)</span>
<span class="co">## - Predefined Times (t)/drawdown measurements (dd):</span>
<span class="co">##         t   dd</span>
<span class="co">## 1     600 0.04</span>
<span class="co">## 2    1200 0.04</span>
<span class="co">## 3    1800 0.06</span>
<span class="co">## 4    2400 0.06</span>
<span class="co">## 5    3600 0.07</span>
<span class="co">## 6    5400 0.09</span>
<span class="co">## 7    7200 0.10</span>
<span class="co">## 8   10800 0.11</span>
<span class="co">## 9   15000 0.13</span>
<span class="co">## 10  21600 0.15</span>
<span class="co">## 11  31200 0.16</span>
<span class="co">## 12  44400 0.18</span>
<span class="co">## 13  63600 0.20</span>
<span class="co">## 14  90600 0.21</span>
<span class="co">## 15 129600 0.23</span>
<span class="co">## </span>
<span class="co">## Observation Well "OW1"</span>
<span class="co">## - Type: Partially penetrating observation well (iows = 0)</span>
<span class="co">## - Delayed response: yes (idpr = 1)</span>
<span class="co">## - Radial dist. from axis of pumped well to obs. well (r) .....: 309.500000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen top (z1) ......: 1.800000 (length)</span>
<span class="co">## - Top of aquifer/initial water table to screen bottom (z2) ...: 7.500000 (length)</span>
<span class="co">## - Inside radius of standpipe where levels change (rp) ........: 1.500000 (length)</span>
<span class="co">## - Length of screened interval (xll) ..........................: 5.700000 (length)</span>
<span class="co">## - Predefined Times (t)/drawdown measurements (dd):</span>
<span class="co">##         t   dd</span>
<span class="co">## 1     600 0.00</span>
<span class="co">## 2    1200 0.00</span>
<span class="co">## 3    1800 0.00</span>
<span class="co">## 4    2400 0.01</span>
<span class="co">## 5    3600 0.01</span>
<span class="co">## 6    5400 0.01</span>
<span class="co">## 7    7200 0.02</span>
<span class="co">## 8   10800 0.03</span>
<span class="co">## 9   15000 0.03</span>
<span class="co">## 10  21600 0.04</span>
<span class="co">## 11  31200 0.05</span>
<span class="co">## 12  44400 0.06</span>
<span class="co">## 13  63600 0.07</span>
<span class="co">## 14  90600 0.08</span>
<span class="co">## 15 129600 0.09</span></code></pre>
<p>and also graphically visualised with the function <code><a href="../reference/wtPlotConfiguration.html">wtPlotConfiguration()</a></code>, e.g.:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtPlotConfiguration.html">wtPlotConfiguration</a></span><span class="op">(</span><span class="va">wtaqConfiguration</span>, asp <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="model-run">Model run<a class="anchor" aria-label="anchor" href="#model-run"></a>
</h4>
<p>For running WTAQ and saving the results in the R object <code>result</code> we just have do use the function <code><a href="../reference/wtRunConfiguration.html">wtRunConfiguration()</a></code> with our above defined model parameterisation <code>wtaqConfiguration</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span><span class="op">(</span><span class="va">wtaqConfiguration</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
</div>
<div class="section level4">
<h4 id="analysing-results">Analysing results<a class="anchor" aria-label="anchor" href="#analysing-results"></a>
</h4>
<p>To print the results of the model run, that are stored in the object <code>result</code> in the <strong>RStudio</strong> console we simply need to enter:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span></code></pre></div>
<pre><code><span class="co">##    WELL   TIME MEASDD    CALCDD  RELERR</span>
<span class="co">## 3    PW    600   0.73 3.808e+00 -421.60</span>
<span class="co">## 4    PW   1200   0.74 4.731e+00 -539.40</span>
<span class="co">## 5    PW   1800   0.75 5.033e+00 -571.00</span>
<span class="co">## 6    PW   2400   0.77 5.189e+00 -573.90</span>
<span class="co">## 7    PW   3600   0.78 5.402e+00 -592.50</span>
<span class="co">## 8    PW   5400   0.80 5.640e+00 -604.90</span>
<span class="co">## 9    PW   7200   0.82 5.825e+00 -610.30</span>
<span class="co">## 10   PW  10800   0.83 6.103e+00 -635.30</span>
<span class="co">## 11   PW  15000   0.85 6.338e+00 -645.60</span>
<span class="co">## 12   PW  21600   0.87 6.602e+00 -658.90</span>
<span class="co">## 13   PW  31200   0.89 6.869e+00 -671.80</span>
<span class="co">## 14   PW  44400   0.92 7.123e+00 -674.30</span>
<span class="co">## 15   PW  63600   0.93 7.380e+00 -693.60</span>
<span class="co">## 16   PW  90600   0.95 7.631e+00 -703.20</span>
<span class="co">## 17   PW 129600   0.96 7.883e+00 -721.10</span>
<span class="co">## 20  OW4    600   0.04 2.162e-02   45.94</span>
<span class="co">## 21  OW4   1200   0.04 4.856e-02  -21.41</span>
<span class="co">## 22  OW4   1800   0.06 6.812e-02  -13.53</span>
<span class="co">## 23  OW4   2400   0.06 8.315e-02  -38.59</span>
<span class="co">## 24  OW4   3600   0.07 1.086e-01  -55.15</span>
<span class="co">## 25  OW4   5400   0.09 1.453e-01  -61.41</span>
<span class="co">## 26  OW4   7200   0.10 1.826e-01  -82.61</span>
<span class="co">## 27  OW4  10800   0.11 2.579e-01 -134.50</span>
<span class="co">## 28  OW4  15000   0.13 3.440e-01 -164.60</span>
<span class="co">## 29  OW4  21600   0.15 4.703e-01 -213.50</span>
<span class="co">## 30  OW4  31200   0.16 6.307e-01 -294.20</span>
<span class="co">## 31  OW4  44400   0.18 8.115e-01 -350.90</span>
<span class="co">## 32  OW4  63600   0.20 1.016e+00 -408.10</span>
<span class="co">## 33  OW4  90600   0.21 1.232e+00 -486.60</span>
<span class="co">## 34  OW4 129600   0.23 1.460e+00 -534.60</span>
<span class="co">## 37  OW1    600   0.00 1.659e-05      NA</span>
<span class="co">## 38  OW1   1200   0.00 4.502e-05      NA</span>
<span class="co">## 39  OW1   1800   0.00 7.374e-05      NA</span>
<span class="co">## 40  OW1   2400   0.01 1.039e-04   98.96</span>
<span class="co">## 41  OW1   3600   0.01 1.747e-04   98.25</span>
<span class="co">## 42  OW1   5400   0.01 3.169e-04   96.83</span>
<span class="co">## 43  OW1   7200   0.02 5.106e-04   97.45</span>
<span class="co">## 44  OW1  10800   0.03 1.081e-03   96.40</span>
<span class="co">## 45  OW1  15000   0.03 2.114e-03   92.95</span>
<span class="co">## 46  OW1  21600   0.04 4.682e-03   88.30</span>
<span class="co">## 47  OW1  31200   0.05 1.075e-02   78.49</span>
<span class="co">## 48  OW1  44400   0.06 2.373e-02   60.45</span>
<span class="co">## 49  OW1  63600   0.07 5.076e-02   27.49</span>
<span class="co">## 50  OW1  90600   0.08 9.924e-02  -24.05</span>
<span class="co">## 51  OW1 129600   0.09 1.775e-01  -97.28</span></code></pre>
<p>For plotting the results we can either use the function <code><a href="../reference/wtPlotResult.html">wtPlotResult()</a></code> with the parameter <code>plottype = "w"</code> to plot for each well measured (MEASDD) and calculated (CALCDD) drawdowns in one plot:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span><span class="op">(</span><span class="va">result</span>, 
             plottype <span class="op">=</span> <span class="st">"w"</span>, 
             main<span class="op">=</span><span class="st">"Pumping test W5: model results without calibration"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: The function hsRenameColumns() is deprecated.</span>
<span class="co">## Please use renameColumns() instead.</span></code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>or produce a plot that contains measured and calculated drawdowns for all wells in two separate plots by setting the parameter <code>plottype = "s"</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span><span class="op">(</span><span class="va">result</span>, 
             plottype <span class="op">=</span> <span class="st">"s"</span>,
             main<span class="op">=</span><span class="st">"Pumping test W5: model results without calibration"</span><span class="op">)</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="model-calibration">Model calibration<a class="anchor" aria-label="anchor" href="#model-calibration"></a>
</h4>
<p>For this tutorial calibration is realised by using an automatised one-dimensional optimisation approach for the following two model parameters, because these were identified to be the most sensitive ones:</p>
<ul>
<li><p><a href="#aquifer-characteristics-horizontal-hydraulic-conductivity-step-1">1. Step: Horizontal hydraulic aquifer conductivity (hkr): for calibrating the drawdown in the observation well</a></p></li>
<li><p><a href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2">2. Step: Well-skin parameter: for calibrating production well drawdown</a></p></li>
</ul>
<p>The approach is valid because the calibration of the well-skin parameter (during Step 2) has no impact on the observation well drawdowns (Step 1). However, it needs to be stated that conditions could occur, where a better model fit could be possible (especially if the mid-term drawdown data are not fitting well) in case that both, vertical <code>hkz</code> and horizontal <code>hkr</code> hydraulic aquifer conductivity are varied in tandem.</p>
<p>Within this tutorial we solve this one-dimensional optimisation problem by using:</p>
<ul>
<li><p>the build-in R function <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimise()</a></code> and</p></li>
<li><p>the Root-Mean-Square-Error (RMSE) as the only performance criteria for evaluating the model fitness (i.e. comparision of calculated and measured drawdowns).</p></li>
</ul>
<p>For solving this optimisation (or: calibration) problem we define the R function <code>calibrateModel()</code> which requires the following four input parameters:</p>
<ul>
<li><p><code>configuration</code>: a valid WTAQ input parameterisation (here: <code>wtaqConfiguration</code>)</p></li>
<li><p><code>wellPattern</code>: a regular expression or the well(s) names to be used for the model fit evaluation (here: <code>OW4</code> or <code>PW</code>)</p></li>
<li><p><code>parameterName</code>: name of the WTAQ parameter that should be calibrated (here: <code>hkr</code> or <code>sw</code>)</p></li>
<li><p><code>parameterRange</code>: allowed value range for calibration parameter (e.g.  <code>c(0.0001, 0.1)</code> for parameter <code>hkr</code>)</p></li>
</ul>
<p>Firstly this function - and its three dependent helper functions <code><a href="../reference/modelFitness.html">modelFitness()</a></code>, <code>modelFitnessAggregated</code> and <code>fitnessAdaptedModelConfiguration()</code> - need to be loaded in R by running the following code:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Package for gof function</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hzambran/hydroGOF" class="external-link">hydroGOF</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: zoo</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'zoo'</span></code></pre>
<pre><code><span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     as.Date, as.Date.numeric</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modelFitness(): called by function modelFitnessAggregated()</span>
<span class="va">modelFitness</span> <span class="op">&lt;-</span> <span class="kw">function</span>
<span class="op">(</span>
  <span class="va">wtaqResult</span>, 
  <span class="va">wellPattern</span>
  <span class="op">)</span>
  <span class="op">{</span>
  <span class="va">subResult</span> <span class="op">&lt;-</span> <span class="va">wtaqResult</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">wellPattern</span>, <span class="va">wtaqResult</span><span class="op">$</span><span class="va">WELL</span><span class="op">)</span>,<span class="op">]</span>
  
  
  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">hydroGOF</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hydroGOF/man/gof.html" class="external-link">gof</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">subResult</span><span class="op">$</span><span class="va">MEASDD</span>, obs <span class="op">=</span> <span class="va">subResult</span><span class="op">$</span><span class="va">CALCDD</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">" %"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co">### data.frame with plenty of performance indicators: e.g. RMSE, NSE, R2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fitness</span><span class="op">)</span>
  <span class="op">}</span>

<span class="co"># modelFitnessAggregated: called by function fitnessAdaptedModelConfiguration()</span>
<span class="va">modelFitnessAggregated</span> <span class="op">&lt;-</span> <span class="kw">function</span> 
<span class="op">(</span>
  <span class="va">wtaqResult</span>, 
  <span class="va">wellPattern</span>
  <span class="op">)</span>
  <span class="op">{</span>
  <span class="va">fitness</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modelFitness.html">modelFitness</a></span><span class="op">(</span><span class="va">wtaqResult</span>, <span class="va">wellPattern</span><span class="op">)</span>
  
  <span class="co">### Objective function for the performance criteria that is minimised, here:</span>
  <span class="va">fitness</span><span class="op">$</span><span class="va">RMSE</span> 
  <span class="op">}</span>

<span class="co"># fitnessAdaptedModelConfiguration: called by function calibrateModel()</span>
<span class="va">fitnessAdaptedModelConfiguration</span> <span class="op">&lt;-</span> <span class="kw">function</span> 
<span class="op">(</span>
  <span class="va">parameterValue</span>, <span class="va">parameterName</span>, <span class="va">configuration</span>, <span class="va">wellPattern</span> 
  <span class="op">)</span> 
  <span class="op">{</span>
  <span class="va">configuration</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtSetParameter.html">wtSetParameter</a></span><span class="op">(</span><span class="va">configuration</span>, <span class="va">parameterName</span>, <span class="va">parameterValue</span><span class="op">)</span>
  
  <span class="va">wtaqResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span><span class="op">(</span><span class="va">configuration</span><span class="op">)</span>
  
  <span class="fu"><a href="../reference/modelFitnessAggregated.html">modelFitnessAggregated</a></span><span class="op">(</span><span class="va">wtaqResult</span>, <span class="va">wellPattern</span><span class="op">)</span>
  <span class="op">}</span>

<span class="co">#calibrateModel()</span>
<span class="va">calibrateModel</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span>
    <span class="co">### WTAQ parameterisation, e.g. as retrieved by wtConfigure()</span>
    <span class="va">configuration</span>,
    <span class="co">### regular expression or name of well(s) to be used for calibration: e.g. "OW4"</span>
    <span class="va">wellPattern</span>,
    <span class="co">### name of ONE WTAQ parameter to be calibrated: e.g. `hkr`, `sw`</span>
    <span class="va">parameterName</span>,
    <span class="co">### min/max range of possible calibration parameter values </span>
    <span class="va">parameterRange</span> 
    <span class="op">)</span> 
    <span class="op">{</span>
    <span class="va">optResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimise</a></span><span class="op">(</span>
      f <span class="op">=</span> <span class="va">fitnessAdaptedModelConfiguration</span>, 
      interval <span class="op">=</span> <span class="va">parameterRange</span>,
      parameterName <span class="op">=</span> <span class="va">parameterName</span>, 
      configuration <span class="op">=</span> <span class="va">configuration</span>, 
      wellPattern <span class="op">=</span> <span class="va">wellPattern</span> <span class="op">)</span>
    
    <span class="co">### Save calibrated WTAQ configuration: </span>
    <span class="va">wtaqConfigurationCalibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wtSetParameter.html">wtSetParameter</a></span><span class="op">(</span>
      configuration <span class="op">=</span> <span class="va">configuration</span>, 
      parameterName <span class="op">=</span> <span class="va">parameterName</span>, 
      parameterValue <span class="op">=</span> <span class="va">optResults</span><span class="op">$</span><span class="va">minimum</span><span class="op">)</span>
    
    <span class="co">### Save optimisation results in list</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parameterName<span class="op">=</span><span class="va">parameterName</span>, 
         wellPattern<span class="op">=</span><span class="va">wellPattern</span>,
         optimalParameterValue<span class="op">=</span><span class="va">optResults</span><span class="op">$</span><span class="va">minimum</span>, 
         minimalPerformanceValue<span class="op">=</span><span class="va">optResults</span><span class="op">$</span><span class="va">objective</span>,
         wtaqConfig<span class="op">=</span><span class="va">wtaqConfigurationCalibrated</span>
         <span class="op">)</span>
    
    <span class="op">}</span></code></pre></div>
<div class="section level5">
<h5 id="aquifer-characteristics-horizontal-hydraulic-conductivity-step-1">Aquifer characteristics: horizontal hydraulic conductivity (Step 1)<a class="anchor" aria-label="anchor" href="#aquifer-characteristics-horizontal-hydraulic-conductivity-step-1"></a>
</h5>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1.Step: Calibrate aquifer characteristics 'hkr' for OW4-------------------------------</span>

<span class="va">calibratedAquifer</span> <span class="op">&lt;-</span> <span class="fu">calibrateModel</span><span class="op">(</span>
  <span class="co">### reference wtaq configuration</span>
  configuration <span class="op">=</span> <span class="va">wtaqConfiguration</span>, 
  <span class="co">### calibrate hydraulic aquifer conductivity</span>
  parameterName <span class="op">=</span> <span class="st">"hkr"</span>,  
  <span class="co">### 'hkr' is within 0.0001 - 0.1 m/s</span>
  parameterRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">0.1</span><span class="op">)</span>, 
  <span class="co">### only use drawdown time-series of OW4 for calibration </span>
  wellPattern <span class="op">=</span> <span class="st">"OW4"</span> 
  <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Plot the drawdowns with calibrated aquifer characteristics:</span>
<span class="fu"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span><span class="op">(</span>wtaqResult <span class="op">=</span> <span class="fu"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span><span class="op">(</span>
  configuration <span class="op">=</span> <span class="va">calibratedAquifer</span><span class="op">$</span><span class="va">wtaqConfig</span><span class="op">)</span>,
  
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Optimal value of parameter '%s' for %s: %0.4f m/s"</span>, 
                 <span class="va">calibratedAquifer</span><span class="op">$</span><span class="va">parameterName</span>, 
                 <span class="va">calibratedAquifer</span><span class="op">$</span><span class="va">wellPattern</span>, 
                 <span class="va">calibratedAquifer</span><span class="op">$</span><span class="va">optimalParameterValue</span><span class="op">)</span>,
  plottype <span class="op">=</span> <span class="st">"w"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<pre><code><span class="co">## Warning: The function hsRenameColumns() is deprecated.</span>
<span class="co">## Please use renameColumns() instead.</span></code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-26-1.png" width="700"> After this step observed and measured drawdowns fit nearly perfectly for the calibrated observation well “OW4” only by setting the <strong>hkr</strong> to <strong>0.0148366</strong> (m/s) , but still the drawdown in the production well “PW” is underestimated (because it is still assumed that here are no “well losses”).</p>
<p>Thus the production well characteristics (i.e. the well-skin parameter <code>sw</code>) need to be calibrated in a next step.</p>
</div>
<div class="section level5">
<h5 id="well-characteristics-well-bore-skin-parameter-of-production-well-step-2">Well characteristics: well-bore skin parameter of production well (Step 2)<a class="anchor" aria-label="anchor" href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2"></a>
</h5>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#2.Step: Calibrate well-bore skin parameter 'sw' for PW-------------------------------</span>
<span class="va">calibratedAquiferAndWellSkin</span> <span class="op">&lt;-</span> <span class="fu">calibrateModel</span><span class="op">(</span>
  <span class="co">#### WTAQ configuration with calibrated aquifer (Step1)</span>
  configuration <span class="op">=</span> <span class="va">calibratedAquifer</span><span class="op">$</span><span class="va">wtaqConfig</span>,
  <span class="co">### calibrate well-bore skin parameter</span>
  parameterName <span class="op">=</span> <span class="st">"sw"</span>, 
  <span class="co">### 'sw' within 0 - 100 (dimensionless)</span>
  parameterRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, 
  <span class="co">### only use drawdown time-series of PW for calibration </span>
  wellPattern <span class="op">=</span> <span class="st">"PW"</span>  
  <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Plot the drawdowns with calibrated aquifer &amp; well-bore skin characteristics:</span>
<span class="fu"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span><span class="op">(</span>wtaqResult <span class="op">=</span> <span class="fu"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span><span class="op">(</span>
  configuration <span class="op">=</span> <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">wtaqConfig</span>,
  <span class="op">)</span>,
  
  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Optimal value of parameter '%s' for %s: %2.4f (dimensionless)"</span>, 
                 <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">parameterName</span>, 
                 <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">wellPattern</span>, 
                 <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">optimalParameterValue</span><span class="op">)</span>,
  plottype <span class="op">=</span> <span class="st">"w"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<pre><code><span class="co">## Warning: The function hsRenameColumns() is deprecated.</span>
<span class="co">## Please use renameColumns() instead.</span></code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>By calibrating the well-skin parameter <strong>sw</strong> to <strong>2.0150393</strong> the drawdown in the production well “PW” now also fits nearly perfectly the observed drawdown values, without impacting the fit for the observation wells.</p>
<p><strong>Note:</strong> <em>There might be cases where the calibration results by following the methodology defined above is not satisfying. This can be possibly solved by calibrating multiple parameters in parallel (e.g. horizontal <code>hkr</code> and vertical hydraulic aquifer conductivity <code>hkz</code>). For this a more complex algorithm (e.g. build-in R function <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>), which is able to solve multi-dimenional optimisation problems, might be usefull. However, this goes beyond the scope of this tutorial.</em></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="level-2-multiple-pumping-wells">Level 2: Multiple pumping wells<a class="anchor" aria-label="anchor" href="#level-2-multiple-pumping-wells"></a>
</h3>
<p><strong>Note:</strong> <em>For performing this example session it is required to perform all steps of the <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example session first, because this example session requires some data of the <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example</em></p>
<p>One challenge of using WTAQ for multiple wells is that the drawdown simulation for each model run is limited to:</p>
<ul>
<li><p>one active production well and</p></li>
<li><p>up to 25 observation wells</p></li>
</ul>
<p>This means that the model parameterisation for the pumping (e.g. pumping rate) and observation wells (e.g. distance to pumping well) needs to be adapted for each model run manually by using the <strong>Level 1</strong> function (see: <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example).</p>
<p>For avoiding such time consuming task additional <strong>Level 2</strong> functions were developed and included in the <em>kwb.wtaq</em> package that simplify using WTAQ on the well-field scale. The usage of these functions is described in the following:</p>
<div class="section level4">
<h4 id="model-parameterisation-1">Model parameterisation<a class="anchor" aria-label="anchor" href="#model-parameterisation-1"></a>
</h4>
<div class="section level5">
<h5 id="well-field">Well field<a class="anchor" aria-label="anchor" href="#well-field"></a>
</h5>
<p>In a first step the well field is defined, by creating a R object <code>owWellfieldConf</code> that contains the following properties for each well, i.e.:</p>
<ul>
<li><p>Location <code>x</code>, <code>y</code>,</p></li>
<li><p>Well diameter <code>r</code>,</p></li>
<li><p>Depth of filter screen top <code>z1</code> and bottom <code>z2</code> below initial groundwater level</p></li>
<li><p>Well-skin parameter <code>sw</code></p></li>
</ul>
<p>For <strong>all</strong> production wells the well-skin parameter <code>sw</code> is set to <code>wellSkin</code>, because this value achieved the best-model fit during <a href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2">calibration for W5</a></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Well-skin parameter from calibration of W5 for all wells of the well field </span>
<span class="va">wellSkin</span> <span class="op">&lt;-</span> <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">optimalParameterValue</span>
<span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Well-skin parameter value: %2.6f (dimensionless)"</span>, <span class="va">wellSkin</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Well-skin parameter value: 2.015039 (dimensionless)"</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example well field configuration with 5 wells</span>
<span class="va">owWellfieldConf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>  
  
  <span class="fu"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span><span class="op">(</span>
    wellName <span class="op">=</span> <span class="st">"W1"</span>, x <span class="op">=</span> <span class="fl">807679.64</span>, y <span class="op">=</span> <span class="fl">2091015.29</span>, 
    r <span class="op">=</span> <span class="fl">1.5</span>, z1 <span class="op">=</span> <span class="fl">2</span>, z2 <span class="op">=</span> <span class="fl">4</span>, sw <span class="op">=</span> <span class="va">wellSkin</span><span class="op">)</span>,  
  
  <span class="fu"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span><span class="op">(</span>
    wellName <span class="op">=</span> <span class="st">"W2"</span>, x <span class="op">=</span> <span class="fl">807608.66</span>, y <span class="op">=</span> <span class="fl">2091018.51</span>, 
    r <span class="op">=</span> <span class="fl">1.7</span>, z1 <span class="op">=</span> <span class="fl">4.2</span>, z2 <span class="op">=</span> <span class="fl">7</span>, sw <span class="op">=</span> <span class="va">wellSkin</span><span class="op">)</span>,
  
  <span class="fu"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span><span class="op">(</span>
    wellName <span class="op">=</span> <span class="st">"W3"</span>, x <span class="op">=</span> <span class="fl">807558.27</span>, y <span class="op">=</span> <span class="fl">2091090.30</span>, 
    r <span class="op">=</span> <span class="fl">1.5</span>, z1 <span class="op">=</span> <span class="fl">1.8</span>, z2 <span class="op">=</span> <span class="fl">8</span>, sw <span class="op">=</span> <span class="va">wellSkin</span><span class="op">)</span>,
  
  <span class="fu"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span><span class="op">(</span>
    wellName <span class="op">=</span> <span class="st">"W4"</span>, x <span class="op">=</span> <span class="fl">807509.29</span>, y <span class="op">=</span>  <span class="fl">2091161.80</span>, 
    r <span class="op">=</span> <span class="fl">1.5</span>, z1 <span class="op">=</span> <span class="fl">1.8</span>, z2 <span class="op">=</span> <span class="fl">7.5</span>, sw <span class="op">=</span> <span class="va">wellSkin</span><span class="op">)</span>,
  
  <span class="fu"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span><span class="op">(</span>
    wellName <span class="op">=</span> <span class="st">"W5"</span>, x <span class="op">=</span> <span class="fl">807458.95</span>, y <span class="op">=</span>  <span class="fl">2091232.26</span>, 
    r <span class="op">=</span> <span class="fl">1.5</span>, z1 <span class="op">=</span> <span class="fl">0.4</span>, z2 <span class="op">=</span> <span class="fl">7.8</span>, sw <span class="op">=</span> <span class="va">wellSkin</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Note:</strong><br><em>On the <strong>Level 2</strong> function level it is now not necessary to define well distances (this was required in the <a href="#model-parameterisation">Level 1: one pumping well example</a>. The well distances will be set later automatically for each model run based on both, the <code>x</code> <code>y</code> coordinates:</em></p>
<pre><code><span class="co">## Well distance matrix table:</span></code></pre>
<pre><code><span class="co">##       W1    W2    W3    W4    W5</span>
<span class="co">## W1        71.1 142.7 224.7 309.5</span>
<span class="co">## W2  71.1        87.7 174.4 261.0</span>
<span class="co">## W3 142.7  87.7        86.7 173.3</span>
<span class="co">## W4 224.7 174.4  86.7        86.6</span>
<span class="co">## W5 309.5 261.0 173.3  86.6</span></code></pre>
<p><em>and on the information which well is operating. For example column “W2” is used if the pumping Well is “W2”</em></p>
</div>
<div class="section level5">
<h5 id="basic-model-parameterisation">Basic model parameterisation<a class="anchor" aria-label="anchor" href="#basic-model-parameterisation"></a>
</h5>
<p>In a next step we define we use the <strong>Level 2</strong> function <code><a href="../reference/owConfigure.html">owConfigure()</a></code> to prepare the constant parts of the WTAQ configuration parameterisation (<code>wellfield</code>, <code>aquifer</code> and <code>drainage</code>) and store them in the object <code>owConf</code>:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create constant components of WTAQ configuration</span>
<span class="va">owConf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/owConfigure.html">owConfigure</a></span><span class="op">(</span>wellfield <span class="op">=</span> <span class="va">owWellfieldConf</span>,
                      aquifer <span class="op">=</span> <span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">wtaqConfig</span><span class="op">$</span><span class="va">aquifer</span>,
                      drainage <span class="op">=</span> <span class="fu"><a href="../reference/wtConfigureDrainage.html">wtConfigureDrainage</a></span><span class="op">(</span>idra <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
                     <span class="op">)</span></code></pre></div>
<p><strong>Note:</strong> <em>For the parameter <code>aquifer</code> we simply use the calibrated parameter setting, that we obtained after the <a href="#model-calibration">Level 1 model calibration</a>, which is stored in the R object:</em></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calibratedAquiferAndWellSkin</span><span class="op">$</span><span class="va">wtaqConfig</span><span class="op">$</span><span class="va">aquifer</span></code></pre></div>
<pre><code><span class="co">## $aqtype</span>
<span class="co">## [1] "WATER TABLE"</span>
<span class="co">## </span>
<span class="co">## $bb</span>
<span class="co">## [1] 10</span>
<span class="co">## </span>
<span class="co">## $hkr</span>
<span class="co">## [1] 0.01483664</span>
<span class="co">## </span>
<span class="co">## $hkz</span>
<span class="co">## [1] 3.5e-05</span>
<span class="co">## </span>
<span class="co">## $ss</span>
<span class="co">## [1] 1e-05</span>
<span class="co">## </span>
<span class="co">## $sy</span>
<span class="co">## [1] 0.05</span></code></pre>
<p>The well field configuration can be plotted with the function <code><a href="../reference/owPlotConfiguration.html">owPlotConfiguration()</a></code> (top view &amp; side view). By setting the parameter <code>referenceWell=1</code> the Well 1 is selected as reference well for plotting:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/owPlotConfiguration.html">owPlotConfiguration</a></span><span class="op">(</span><span class="va">owConf</span>,  referenceWell <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-32-1.png" width="960"></p>
</div>
<div class="section level5">
<h5 id="time-varying-model-parameteristion">Time-varying model parameteristion<a class="anchor" aria-label="anchor" href="#time-varying-model-parameteristion"></a>
</h5>
<p>The time-variant model parameterisation contains:</p>
<ul>
<li><p>the pumping rates (<code>pumpingRates</code>) of each well (here: defined in <code>owWellfieldConf</code>) and</p></li>
<li><p>the times for which the drawdowns should be calculated (<code>timesForDDcalculation</code>)</p></li>
</ul>
<p>These are defined in the following code:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pumping rates of well W1 to W5</span>
<span class="va">pumpingRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.069</span>, <span class="fl">0.089</span>, <span class="fl">0.088</span>, <span class="fl">0.087</span>, <span class="fl">0.086</span><span class="op">)</span> 

<span class="co">### user-specified times</span>
<span class="va">timesForDDcalculation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">30</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">1200</span>, <span class="fl">2400</span>,<span class="fl">3600</span>, 
                           <span class="fl">10000</span>, <span class="fl">50000</span>, <span class="fl">100000</span>, <span class="fl">300000</span><span class="op">)</span> </code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="model-run-1">Model run<a class="anchor" aria-label="anchor" href="#model-run-1"></a>
</h4>
<p>Now we have all parts for parameterising WTAQ and calulating the drawdowns easily on the well field scale (i.e. running WTAQ multiple times in the background).</p>
<p>For this we use the function <code><a href="../reference/owGetDrawdowns.html">owGetDrawdowns()</a></code> with the following parameters:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ddlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/owGetDrawdowns.html">owGetDrawdowns</a></span><span class="op">(</span>
  owConf<span class="op">=</span><span class="va">owConf</span>, 
  Q <span class="op">=</span> <span class="va">pumpingRates</span>, 
  times <span class="op">=</span> <span class="va">timesForDDcalculation</span>,
  <span class="co">### required for using the function wtPlotResults()</span>
  to.matrix<span class="op">=</span><span class="cn">FALSE</span> 
  <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ddmatrix</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/owGetDrawdowns.html">owGetDrawdowns</a></span><span class="op">(</span>
  owConf<span class="op">=</span><span class="va">owConf</span>, 
  Q <span class="op">=</span> <span class="va">pumpingRates</span>, 
  times <span class="op">=</span> <span class="va">timesForDDcalculation</span>,
  <span class="co">### saves results in "matrix" format: required for function owSuperposeDrawdowns()</span>
  to.matrix<span class="op">=</span><span class="cn">TRUE</span> 
  <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span>

<span class="co">## Warning in type.convert.default(block[, i]): 'as.is' should be specified by the</span>
<span class="co">## caller; using TRUE</span></code></pre>
<p>The switch <code>to.matrix=TRUE</code> is required in case one would like to calculate the total drawdown in each well including well interference with the function <code><a href="../reference/owSuperposeDrawdowns.html">owSuperposeDrawdowns()</a></code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">drawdownsWithWellInterference</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/owSuperposeDrawdowns.html">owSuperposeDrawdowns</a></span><span class="op">(</span>drawdownList <span class="op">=</span> <span class="va">ddmatrix</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="analysing-results-1">Analysing results<a class="anchor" aria-label="anchor" href="#analysing-results-1"></a>
</h4>
<p><strong>Quantifying the impact of well interference</strong></p>
<p>Finally the modelling results can be analysed. For example it is possible to quantify the additional drawdown due to well interference, e.g. for “W1”:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myWell</span> <span class="op">&lt;-</span> <span class="st">"W1"</span>
<span class="va">DD_inProductionWell_withInterference</span> <span class="op">&lt;-</span> <span class="va">drawdownsWithWellInterference</span><span class="op">[</span>,<span class="va">myWell</span><span class="op">]</span> 
<span class="va">DD_inProductionWell_withoutInterference</span> <span class="op">&lt;-</span> <span class="va">ddmatrix</span><span class="op">[[</span><span class="va">myWell</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">myWell</span><span class="op">]</span>
<span class="va">diffDrawdown</span> <span class="op">&lt;-</span> <span class="va">DD_inProductionWell_withInterference</span><span class="op">-</span><span class="va">DD_inProductionWell_withoutInterference</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time.in.seconds<span class="op">=</span><span class="va">drawdownsWithWellInterference</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,
      additionalDrawdown.due.to.wellInterference.in.meter<span class="op">=</span><span class="va">diffDrawdown</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    time.in.seconds additionalDrawdown.due.to.wellInterference.in.meter</span>
<span class="co">## 1                1                                         0.000000000</span>
<span class="co">## 2                5                                         0.000016160</span>
<span class="co">## 3               10                                         0.000116362</span>
<span class="co">## 4               30                                         0.001717690</span>
<span class="co">## 5               60                                         0.007218800</span>
<span class="co">## 6              600                                         0.101305000</span>
<span class="co">## 7             1200                                         0.119617000</span>
<span class="co">## 8             2400                                         0.140303000</span>
<span class="co">## 9             3600                                         0.159315000</span>
<span class="co">## 10           10000                                         0.242770000</span>
<span class="co">## 11           50000                                         0.483100000</span>
<span class="co">## 12          100000                                         0.607290000</span>
<span class="co">## 13          300000                                         0.810100000</span></code></pre>
<p><strong>Plotting of well drawdowns (without well interference):</strong></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">wellName</span> <span class="kw">in</span> <span class="va">owWellfieldConf</span><span class="op">$</span><span class="va">wellName</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">owWellfieldConf</span><span class="op">$</span><span class="va">wellName</span><span class="op">==</span><span class="va">wellName</span><span class="op">)</span>
 <span class="va">wellQ</span> <span class="op">&lt;-</span> <span class="va">pumpingRates</span><span class="op">[</span><span class="va">index</span><span class="op">]</span>
 <span class="kw">if</span> <span class="op">(</span><span class="va">wellQ</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
 <span class="op">{</span>
  <span class="fu"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span><span class="op">(</span>wtaqResult <span class="op">=</span> <span class="va">ddlist</span><span class="op">[[</span><span class="va">wellName</span><span class="op">]</span><span class="op">]</span>, 
               plottype <span class="op">=</span> <span class="st">"s"</span>, 
               ylab <span class="op">=</span> <span class="st">"Drawdown (m)"</span>,
               xlab <span class="op">=</span> <span class="st">"Time in seconds since start of pumping (s)"</span>,
               main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Pumping well: %s (Q: %3.1f m3/h)"</span>, 
                              <span class="va">wellName</span>,                                   
                              <span class="va">wellQ</span><span class="op">*</span><span class="fl">3600</span><span class="op">)</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-1.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-2.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-3.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-4.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-5.png" width="700"></p>
<p><strong>Plotting of well drawdowns (with well interference):</strong></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plotWellInterference</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">wellName</span>, <span class="va">Q</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
<span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s "</span>,<span class="va">wellName</span><span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (%3.1f m3/h) "</span>,<span class="va">wellName</span>, <span class="va">Q</span><span class="op">*</span><span class="fl">3600</span><span class="op">)</span>
    <span class="op">}</span>
  
  <span class="va">drawdown</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SCENARIO<span class="op">=</span><span class="st">"no well interference"</span>, 
                         TIME<span class="op">=</span><span class="va">ddmatrix</span><span class="op">[[</span><span class="va">wellName</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="st">"TIME"</span><span class="op">]</span>, 
                         CALCDD<span class="op">=</span><span class="va">ddmatrix</span><span class="op">[[</span><span class="va">wellName</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">wellName</span><span class="op">]</span><span class="op">)</span>
  <span class="va">drawdownWithInterference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"SCENARIO"</span><span class="op">=</span><span class="st">"with well interference"</span>, 
                         TIME<span class="op">=</span><span class="va">drawdownsWithWellInterference</span><span class="op">[</span>,<span class="st">"TIME"</span><span class="op">]</span>, 
                         CALCDD<span class="op">=</span><span class="va">drawdownsWithWellInterference</span><span class="op">[</span>,<span class="va">wellName</span><span class="op">]</span><span class="op">)</span>
  
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">drawdown</span>, <span class="va">drawdownWithInterference</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">CALCDD</span> <span class="op">~</span> <span class="va">TIME</span>, 
                        groups <span class="op">=</span>  <span class="va">SCENARIO</span>, 
                        ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/extendrange.html" class="external-link">extendrange</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">CALCDD</span><span class="op">)</span><span class="op">)</span>,
                        ylab <span class="op">=</span> <span class="st">"Drawdown (m)"</span>,
                        xlab <span class="op">=</span> <span class="st">"Time in seconds since start of pumping (s)"</span>,
                        type<span class="op">=</span><span class="st">"b"</span>, 
                        auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>columns<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, 
                        data<span class="op">=</span><span class="va">res</span>, 
                        main <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">wellName</span> <span class="kw">in</span> <span class="va">owWellfieldConf</span><span class="op">$</span><span class="va">wellName</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">owWellfieldConf</span><span class="op">$</span><span class="va">wellName</span><span class="op">==</span><span class="va">wellName</span><span class="op">)</span>
 <span class="va">wellQ</span> <span class="op">&lt;-</span> <span class="va">pumpingRates</span><span class="op">[</span><span class="va">index</span><span class="op">]</span>
 <span class="fu">plotWellInterference</span><span class="op">(</span>wellName <span class="op">=</span> <span class="va">wellName</span>, Q <span class="op">=</span> <span class="va">wellQ</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-1.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-2.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-3.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-4.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-5.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hauke Sonnenberg, FAKIN, OPTIWELLS-2.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
