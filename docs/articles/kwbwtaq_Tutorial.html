<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial for R package kwb.wtaq • kwb.wtaq</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial for R package kwb.wtaq">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.wtaq</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/kwbwtaq_ParameterTable.html">Parameters of configuration functions in kwb.wtaq</a>
    </li>
    <li>
      <a href="../articles/kwbwtaq_Tutorial.html">Tutorial for R package kwb.wtaq</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial for R package kwb.wtaq</h1>
                        <h4 class="author">Hauke Sonnenberg &amp; Michael Rustler (Kompetenzzentrum Wasser Berlin gGmbH)</h4>
            
            <h4 class="date">Juli 10, 2018</h4>
      
      
      <div class="hidden name"><code>kwbwtaq_Tutorial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><strong>Background</strong></p>
<p>Within the OPTIWELLS-2 project, sponsored by Veolia Water, a detailed study was performed for screening available models that:</p>
<ul>
<li><p>are able to simulate time-dependent well drawdown</p></li>
<li><p>also include the additional drawdown in case of well interference and</p></li>
<li><p>are quite easy to parameterise</p></li>
</ul>
<p>The semi-analytical groundwater model WTAQ-2 was chosen, because it fitted best with the above defined requirements. However, as the model is programmed in FORTRAN it requires that the user follows the steps that are listed below:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Step: Definition and parameterisation of text input file,</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Step: Execution of the WTAQ-2 model engine in MS DOS command shell</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Step: Saving of model results in a text output file</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Step: Reading and analysing of model outputs</li>
</ol></li>
<li><ol start="5" style="list-style-type: decimal">
<li>Step (in case of well interference): looping through Steps 1-4 for each active production well and superposition of additional drawdowns due to well interference</li>
</ol></li>
</ul>
<p>For simplifying this process it was decided to build an R package that enables to perform all these steps and also includes the WTAQ-2 model engine (for more details see: <a href="https://doi.org/10.13140/RG.2.1.2140.3683">Sonnenberg et al., 2014</a>). This R package <em>kwb.wtaq</em> was developed by Hauke Sonnenberg at Kompetenzzentrum Wasser Berlin (KWB). It provides an Application Programming Interface (API) to the analytical groundwater drawdown model WTAQ-2, developed by the United States Geological Survey (USGS) and provided for free (for further information on WTAQ-2 see: <a href="http://water.usgs.gov/ogw/wtaq/" class="uri">http://water.usgs.gov/ogw/wtaq/</a>). In the following we will simply use “WTAQ” when referring to the software WTAQ-2.</p>
<p><strong>Objective</strong></p>
<p>The objective of this tutorial is to demonstrate how the functions from the R-package <em>kwb.wtaq</em> can be used to configure and run a WTAQ model setup and to read the resulting groundwater drawdowns from the output files that are generated by the WTAQ model software.</p>
<div id="preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#preparation" class="anchor"></a>Preparation</h2>
<p>In order to use the R package you need to have the <strong>R programming environment (in version 3.0 or higher)</strong> installed on your computer. You can download it for free from <a href="http://cran.rstudio.com/" class="uri">http://cran.rstudio.com/</a>.</p>
<p>As Integrated Programming Interface (IDE) for the R environment we recommend — and for the purpose of this tutorial require — to use the free software <strong>RStudio</strong>. You can download RStudio from: <a href="http://www.rstudio.com/products/rstudio/download/" class="uri">http://www.rstudio.com/products/rstudio/download/</a>.</p>
<p>The programming environment R is shipped with a basic set of functions. It can be extended by so-called packages that contain user-defined functions. We used this packaging mechanism and provide the access functions to WTAQ in the form of an R package that we named <em>kwb.wtaq</em>.</p>
<p>Before you can start using the functions provided in the package you need to</p>
<ol style="list-style-type: decimal">
<li><p>Install the package into your R programming environment and</p></li>
<li><p>Load the package into your current R session.</p></li>
</ol>
<div id="installation-of-required-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#installation-of-required-r-packages" class="anchor"></a>Installation of required R packages</h3>
<p>Since the package <em>kwb.wtaq</em> depends on a number of other packages, not only <em>kwb.wtaq</em> but also all the packages that it depends on need to be installed.</p>
<p>In order to simplify the package installation run the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">"devtools"</span>)) { <span class="kw">install.packages</span>(<span class="st">"devtools"</span>) }
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="dt">repo =</span> <span class="st">"KWB-R/kwb.wtaq"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>This will download and install the package <strong><a href="https://github.com/KWB-R/kwb.wtaq">kwb.wtaq</a></strong> with all required dependencies, i.e.:</p>
<ul>
<li><p>publicly available packages from the Comprehensive R Archive Network (CRAN) and</p></li>
<li><p>the KWB Github package <a href="https://github.com/KWB-R/kwb.utils">kwb.utils</a></p></li>
</ul>
<p>If the installation succeeds the messages generated should read like these:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## package 'zoo' successfully unpacked and MD5 sums checked
## package 'hydroGOF' successfully unpacked and MD5 sums checked
## package 'lattice' successfully unpacked and MD5 sums checked
## package 'plotrix' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  C:\Dokumente und Einstellungen\Key Hauke\Lokale Einstellungen\Temp\RtmpctBYMz\downloaded_packages
## package 'kwb.utils' successfully unpacked and MD5 sums checked</code></pre></div>
<p>The installation needs to be done only once. The packages keep installed until you decide to uninstall them. Uninstalling a package in RStudio can be done by clicking on the <code>Remove package</code> button right to the package name on the “Packages” tab.</p>
</div>
<div id="loading-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-the-package" class="anchor"></a>Loading the package</h3>
<p>Once you have installed all the requied packages you are almost ready to use the functions contained in the package <em>kwb.wtaq</em>.</p>
<p>As a last step you need to explicitly load the package into your current R session by running the following R command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(kwb.wtaq)</code></pre></div>
<p>You will see messages stating the progress of loading not only the package <em>kwb.wtaq</em> but also of all the packages that it depends on.</p>
<p>You may see warnings that the packages have been built under R in a higher version compared to the version that you are using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Warning: package 'kwb.utils' was built under R version 3.0.3</code></pre></div>
<p>Unless you are using R in a version prior to 3.0 these messages do not indicate a problem and can be ignored.</p>
<p>Please note that the functions provided in the <em>kwb.wtaq</em> package can only be used when the package is loaded with <code>library(kwb.wtaq)</code> as shown here. This needs to be done each time you start a new R session or each time you open RStudio. If you write an R script that uses the functions from <em>kwb.wtaq</em> then it would be a good practice to put <code>library(kwb.wtaq)</code> as one of the first lines of your script.</p>
</div>
</div>
<div id="using-the-package-help" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-package-help" class="anchor"></a>Using the package help</h2>
<p>A detailed description of the WTAQ model parameters is available in the <a href="http://pubs.usgs.gov/tm/tm3b9/pdf/tm3-b9_barlow_wtaqv2_report.pdf">WTAQ documentation</a>. However, within ‘RStudio’ is not always necessary to consult this manual, because the parameter description is integrated in the <strong>kwb.wtaq</strong> package help. These information can be accessed by pressing <code>Ctrl</code> and <code>Space</code> simultaneously, if the cursor is located within a function, e.g. <code>wtConfGeneral()</code>:</p>
<div class="figure">
<img src="pictures/ontheflyhelp.jpg" alt="On the fly help in RStudio"><p class="caption">On the fly help in RStudio</p>
</div>
<p>The help file for each R function in <code>RStudio</code> can be accessed by using the R command <code><a href="http://www.rdocumentation.org/packages/devtools/topics/help">help(functionname)</a></code> or using <code>?</code> before the functionname, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?kwb.wtaq<span class="op">::</span>wtConfigure
<span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/help">help</a></span>(kwb.wtaq<span class="op">::</span>wtConfigure)</code></pre></div>
<p><strong>Note:</strong> <em>Typing <code>kwb.wtaq::</code> before the function name is only needed if you haven’t loaded the package into your R session with <code>library(kwb.wtaq)</code> (see <a href="#loading-the-package">Loading the package</a>)</em></p>
<p>In addition, we also provide a <a href="kwbwtaq_ParameterTable.html">full description</a> of all the parameters that are accepted by the configuration functions, which are descriped later in this tutorial.</p>
</div>
</div>
<div id="example-sessions" class="section level1">
<h1 class="hasAnchor">
<a href="#example-sessions" class="anchor"></a>Example sessions</h1>
<div id="level-1-one-pumping-well" class="section level2">
<h2 class="hasAnchor">
<a href="#level-1-one-pumping-well" class="anchor"></a>Level 1: One pumping well</h2>
<div id="pumping-test-data" class="section level3">
<h3 class="hasAnchor">
<a href="#pumping-test-data" class="anchor"></a>Pumping test data</h3>
<p>We have provided an example dataset “drawdowns” containing four different pumping tests with measured drawdown time-series in five different wells (production well and four observation wells). You can load the dataset by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"drawdowns"</span>, <span class="dt">package =</span> <span class="st">"kwb.wtaq"</span>)</code></pre></div>
<p>Let’s have a short look to the dataset. It is a list of four data frames as the R command “str” reveals:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(drawdowns)</code></pre></div>
<pre><code>## List of 4
##  $ W1:'data.frame':  15 obs. of  6 variables:
##   ..$ time.in.seconds: num [1:15] 420 1020 1620 2820 4020 ...
##   ..$ W1             : num [1:15] 1.25 1.42 1.46 1.52 1.56 ...
##   ..$ W2             : num [1:15] 0.02 0.04 0.05 0.07 0.08 ...
##   ..$ W3             : num [1:15] 0 0.01 0.01 0.02 0.03 ...
##   ..$ W4             : num [1:15] 0 0 0.01 0.02 0.02 ...
##   ..$ W5             : num [1:15] 0 0.01 0.01 0.01 0.01 ...
##  $ W2:'data.frame':  15 obs. of  6 variables:
##   ..$ time.in.seconds: num [1:15] 120 720 1320 2520 3720 ...
##   ..$ W2             : num [1:15] 1.2 1.73 1.62 1.68 1.75 ...
##   ..$ W1             : num [1:15] 0.01 0.05 0.06 0.09 0.1 ...
##   ..$ W3             : num [1:15] 0 0.02 0.03 0.05 0.06 ...
##   ..$ W4             : num [1:15] 0 0 0.01 0.01 0.02 ...
##   ..$ W5             : num [1:15] 0 0.01 0.01 0.01 0.01 ...
##  $ W4:'data.frame':  15 obs. of  6 variables:
##   ..$ time.in.seconds: num [1:15] 60 660 1260 2460 3660 ...
##   ..$ W4             : num [1:15] 0.5 0.76 0.79 0.82 0.84 ...
##   ..$ W1             : num [1:15] 0 0 0.01 0.02 0.02 ...
##   ..$ W2             : num [1:15] 0.01 0.01 0.01 0.02 0.03 ...
##   ..$ W3             : num [1:15] 0.01 0.05 0.06 0.08 0.1 ...
##   ..$ W5             : num [1:15] 0.01 0.04 0.05 0.07 0.08 ...
##  $ W5:'data.frame':  15 obs. of  6 variables:
##   ..$ time.in.seconds: num [1:15] 600 1200 1800 2400 3600 5400 7200 10800 15000 21600 ...
##   ..$ W5             : num [1:15] 0.73 0.74 0.75 0.77 0.78 ...
##   ..$ W1             : num [1:15] 0 0 0 0.01 0.01 ...
##   ..$ W2             : num [1:15] 0 0 0 0 0 ...
##   ..$ W3             : num [1:15] 0.01 0.01 0.01 0.01 0.02 ...
##   ..$ W4             : num [1:15] 0.04 0.04 0.06 0.06 0.07 ...</code></pre>
<p>The four list elements represent four different pumping tests (in “W1”, “W2”, “W4” and “W5”. The resulting drawdowns of each pumping test are stored in a data frame of six columns. Column “time.in.seconds” contains the time in seconds since the start of a pumping test. The columns “W1” through “W5” contain the water table drawdowns measured in the corresponding wells “W1” to “W5”,in meters below the initial water table.</p>
<p>For example, the fourth pumping test, during which a discharge of Q = 313 m3/h was measured in Well W5, resulted in the following drawdowns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">drawdowns[[<span class="st">"W5"</span>]]</code></pre></div>
<pre><code>##    time.in.seconds   W5   W1   W2   W3   W4
## 1              600 0.73 0.00 0.00 0.01 0.04
## 2             1200 0.74 0.00 0.00 0.01 0.04
## 3             1800 0.75 0.00 0.00 0.01 0.06
## 4             2400 0.77 0.01 0.00 0.01 0.06
## 5             3600 0.78 0.01 0.00 0.02 0.07
## 6             5400 0.80 0.01 0.01 0.03 0.09
## 7             7200 0.82 0.02 0.01 0.04 0.10
## 8            10800 0.83 0.03 0.02 0.05 0.11
## 9            15000 0.85 0.03 0.03 0.06 0.13
## 10           21600 0.87 0.04 0.04 0.08 0.15
## 11           31200 0.89 0.05 0.05 0.09 0.16
## 12           44400 0.92 0.06 0.06 0.11 0.18
## 13           63600 0.93 0.07 0.07 0.12 0.20
## 14           90600 0.95 0.08 0.08 0.14 0.21
## 15          129600 0.96 0.09 0.09 0.15 0.23</code></pre>
<p>It seems as if the drawdowns reach a steady-state after a certain time. This can be judged better by a diagram that can be produced in R by using the xyplot function from the R-package “lattice”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lattice<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lattice/topics/xyplot">xyplot</a></span>(W1 <span class="op">+</span><span class="st"> </span>W2 <span class="op">+</span><span class="st"> </span>W3 <span class="op">+</span><span class="st"> </span>W4 <span class="op">+</span><span class="st"> </span>W5 <span class="op">~</span><span class="st"> </span>time.in.seconds, 
       <span class="dt">data =</span> drawdowns[[<span class="st">"W5"</span>]], 
       <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">"b"</span>, <span class="st">"g"</span>), <span class="co"># (b)oth, dots and lines, and a (g)rid</span>
       <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">columns =</span> <span class="dv">5</span>), <span class="co"># legend arranged in five columns</span>
       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="fl">0.1</span>),
       <span class="dt">ylab=</span> <span class="st">"Drawdown (m)"</span>, <span class="co"># label of y-Axis</span>
       <span class="dt">xlab=</span> <span class="st">"Time in seconds since start of pumping in W5 (s)"</span>) <span class="co"># label of y-Axis</span></code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="model-parameterisation" class="section level3">
<h3 class="hasAnchor">
<a href="#model-parameterisation" class="anchor"></a>Model parameterisation</h3>
<p>In a first step a WTAQ input file needs to be defined. This can be realised with two different functions:</p>
<ul>
<li><p><code><a href="../reference/wtConfigure.html">wtConfigure()</a></code>: definition of WTAQ configuration within R</p></li>
<li><p><code><a href="../reference/wtReadInputFile.html">wtReadInputFile()</a></code>: importing of WTAQ configuration from existing WTAQ input text file into R</p></li>
</ul>
<p>The WTAQ input file can be directly defined in R using the function <code><a href="../reference/wtConfigure.html">wtConfigure()</a></code> and saved in the R object <code>wtaqConfiguration</code> (for a full description of all the parameters that are accepted by the configuration functions, see: <a href="kwbwtaq_ParameterTable.html">Parameter tables</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">generalConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureGeneral.html">wtConfigureGeneral</a></span>(
  ### title of the project (max. length 70 characters)
  <span class="dt">title=</span><span class="st">"Example well field, long-term pumping test of well 5"</span>
  )

aquiferConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureAquifer.html">wtConfigureAquifer</a></span>(    
  <span class="dt">aqtype =</span> <span class="st">"WATER TABLE"</span>, <span class="co"># aquifer type</span>
  <span class="dt">bb =</span> <span class="dv">10</span>,                <span class="co"># saturated aquifer thickness</span>
  <span class="dt">hkr =</span> <span class="fl">1E-03</span>,            <span class="co"># horizontal hydraulic conductivity</span>
  <span class="dt">hkz =</span> <span class="fl">3.5E-05</span>,          <span class="co"># vertical hydraulic conductivity</span>
  <span class="dt">ss =</span> <span class="fl">1E-05</span>,             <span class="co"># specific storage</span>
  <span class="dt">sy =</span> <span class="fl">0.05</span>               <span class="co"># specific yield</span>
)

drainageConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureDrainage.html">wtConfigureDrainage</a></span>(
  <span class="dt">idra =</span> <span class="dv">0</span> <span class="co"># = instantaneous drainage in unsaturated zone</span>
)

timesConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureTimes.html">wtConfigureTimes</a></span>(
  <span class="dt">its =</span> <span class="dv">1</span> <span class="co"># = user-specified time-steps</span>
)</code></pre></div>
<p>In the following we will configure one pumping well and two observation wells (for simplifying the tutorial we restrict ourselves to two instead of four observation wells four which drawdown time series are available).</p>
<p>Since WTAQ allows to define time-series of measured drawdowns for each well, the corresponding functions <code><a href="../reference/wtConfigurePumpwell.html">wtConfigurePumpwell()</a></code> and <code><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell()</a></code>, that are described in the following, also allow to specify these measured drawdown values. For this example, we want to use the drawdowns of the fourth pumping test, provided in the example dataset <code>drawdowns</code>. We store it in a separate variable <code>drawdowns5</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">drawdowns5 &lt;-<span class="st"> </span>drawdowns[[<span class="st">"W5"</span>]]</code></pre></div>
<p>Now we prepare some data frames (a table-like structure in R, defined by rows and columns, see <code>?data.frame</code>) representing three drawdown time series, which are measured at :</p>
<ul>
<li><p>the pumping well “PW” and</p></li>
<li><p>two different observation wells “OW1” and “OW4”.</p></li>
</ul>
<p>By doing this we simplify the programmig code that is used later on:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the times of observations are the same for all wells:</span>
times &lt;-<span class="st"> </span>drawdowns5<span class="op">$</span>time.in.seconds

<span class="co"># observed drawdowns at the pumping well</span>
observed.PW  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> times, <span class="dt">dd =</span> drawdowns5<span class="op">$</span>W5)

<span class="co"># observed drawdowns at the observation wells</span>
observed.OW1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> times, <span class="dt">dd =</span> drawdowns5<span class="op">$</span>W1)
observed.OW4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t =</span> times, <span class="dt">dd =</span> drawdowns5<span class="op">$</span>W4)</code></pre></div>
<p>Let’s start with the configuration of the pumping well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pumpwellConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigurePumpwell.html">wtConfigurePumpwell</a></span>(
  ### partially penetrating pumped well
  <span class="dt">ipws =</span> <span class="dv">0</span>,
  ### finite diameter well
  <span class="dt">ipwd =</span> <span class="dv">1</span>, 
  ### pumping rate of production well in (here: m3/s)
  <span class="dt">qq =</span> <span class="fl">0.0869</span>, 
  ### radius of pumped well-screen (here: meter) 
  <span class="dt">rw =</span> <span class="fl">1.5</span>, 
  ### top of filter screen below initial water table (here: meter)
  <span class="dt">zpd =</span> <span class="fl">0.4</span>, 
  ### bottom of filter screen below initial water table (here: meter)
  <span class="dt">zpl =</span> <span class="fl">7.8</span>, 
  ### well-bore skin parameter (dimensionless)
  <span class="dt">sw =</span> <span class="dv">0</span>, 
  ### data.frame with times and measured drawdown data in pumping well
  <span class="dt">tspw =</span> observed.PW 
)</code></pre></div>
<p>Now, let’s define our first observation well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">observationWell1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell</a></span>(
  ### name of observation well
  <span class="dt">obname =</span> <span class="st">"OW1"</span>, 
  ### distance from pumping well (here: meters)
  <span class="dt">r =</span> <span class="fl">309.5</span>, 
  ### partially penetrating observation well
  <span class="dt">iows =</span> <span class="dv">0</span>, 
  ### delayed response
  <span class="dt">idpr =</span> <span class="dv">1</span>, 
  ### top of filter screen below initial water table (here: meters)
  <span class="dt">z1 =</span> <span class="fl">1.8</span>, 
  ### bottom of filter screen below initial water table (here: meters)
  <span class="dt">z2 =</span> <span class="fl">7.5</span>, 
  ### inside radius of the observation well (here: meters)
  <span class="dt">rp =</span> <span class="fl">1.5</span>, 
  ### data.frame with times and measured drawdown data in OW1
  <span class="dt">tsobs=</span> observed.OW1 
)</code></pre></div>
<p>In the same way, we define a second observation well “OW4” (in a formally more compact way to save some space here):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">observationWell4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigureObservationWell.html">wtConfigureObservationWell</a></span>(<span class="dt">obname =</span> <span class="st">"OW4"</span>, <span class="dt">r =</span> <span class="fl">86.6</span>,
  <span class="dt">iows =</span> <span class="dv">0</span>, <span class="dt">idpr =</span> <span class="dv">1</span>, <span class="dt">z1 =</span> <span class="fl">1.8</span>, <span class="dt">z2 =</span> <span class="fl">7.5</span>, <span class="dt">rp =</span> <span class="fl">1.5</span>, <span class="dt">tsobs =</span> observed.OW4)</code></pre></div>
<p>Out of these parts of configuration we can build one complete configuration by using the function <code><a href="../reference/wtConfigure.html">wtConfigure()</a></code>. It returns a R list structure that represents a model configuration containing all the necessary information that WTAQ requires to perform a model run. This information is saved in the R object <code>wtaqConfiguration</code> and will be used for the following chapters of this tutorial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wtaqConfiguration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtConfigure.html">wtConfigure</a></span>(
  <span class="dt">general =</span> generalConfiguration,
  <span class="dt">aquifer =</span> aquiferConfiguration, 
  <span class="dt">drainage =</span> drainageConfiguration, 
  <span class="dt">times =</span> timesConfiguration, 
  <span class="dt">solution =</span> <span class="kw"><a href="../reference/wtConfigureSolution.html">wtConfigureSolution</a></span>(),
  <span class="dt">pumpwell =</span> pumpwellConfiguration,
  <span class="dt">obswells =</span> <span class="kw">list</span>(observationWell4, 
                  observationWell1)
)</code></pre></div>
<p><strong>Note:</strong> <em>Alternatively it is possible to load WTAQ input text files diretly into R with the function <code><a href="../reference/wtReadInputFile.html">wtReadInputFile()</a></code> from an already existing WTAQ input text file, e.g.:</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inputFile &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"example1.inp"</span>, <span class="dt">package =</span> <span class="st">"kwb.wtaq"</span>)
wtaqConfiguration2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtReadInputFile.html">wtReadInputFile</a></span>(inputFile)</code></pre></div>
<p><em>However, in this tutorial we just focus on the example that is stored in the R object <code>wtaqConfiguration</code>.</em></p>
<p>For checking this model parameterisation it can be printed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wtaqConfiguration</code></pre></div>
<pre><code>## General
## - Title:  Example well field, long-term pumping test of well 5 
## - Format: DIMENSIONAL 
## 
## Aquifer
## - Type: WATER TABLE 
## - Thickness (bb) ............: 10.000000 (length)
## - Horiz. hydr. conduct. (hkr): 0.001000 (length/time)
## - Vert.  hydr. conduct. (hkz): 0.000035 (length/time)
## - Specific storage (ss) .....: 0.000010 (1/length)
## - Specific yield (sy) .......: 0.050000
## 
## Drainage
## - Type: Instantaneous drainage (idra = 0)
## 
## Times
## - Type: User-specified times (its = 1)
## 
## Solution
## - Type: de Hoog algorithm (isoln = 2)
## - Rel. err. for Newton-Raphson iter. (rerrnr) ...................: 0.000000
## - Rel. err. sought for accur. of the num. invers. (error) .......: 0.000100
## - Factor to determ. # terms in finite summations (ntms) .........: 30
## - # terms in summ. of Fourier series for inv. Lapl. transf. (nnn): 6
## - Method used to accelerate convergence of Fourier series .......: 3
## 
## Pumped Well ("PW")
## - Type: Partially penetrating pumped well (ipws = 0)
## - Type of diameter: Finite diameter (ipwd = 1)
## - Pumping rate (qq) .......................................: 0.086900 (length^3/time)
## - Radius of screen (rw) ...................................: 1.500000 (length)
## - Inside radius where levels change during pumping (rc) ...: 1.500000 (length)
## - Top of aquifer/initial water table to screen top (zpd) ..: 0.400000 (length)
## - Top of aquifer/initial water table to screen bottom (zpl): 7.800000 (length)
## - Well-bore skin parameter (sw) ...........................: 0.000000 
## - Predefined Times (t)/drawdown measurements (dd):
##         t   dd
## 1     600 0.73
## 2    1200 0.74
## 3    1800 0.75
## 4    2400 0.77
## 5    3600 0.78
## 6    5400 0.80
## 7    7200 0.82
## 8   10800 0.83
## 9   15000 0.85
## 10  21600 0.87
## 11  31200 0.89
## 12  44400 0.92
## 13  63600 0.93
## 14  90600 0.95
## 15 129600 0.96
## 
## Observation Well "OW4"
## - Type: Partially penetrating observation well (iows = 0)
## - Delayed response: yes (idpr = 1)
## - Radial dist. from axis of pumped well to obs. well (r) .....: 86.600000 (length)
## - Top of aquifer/initial water table to screen top (z1) ......: 1.800000 (length)
## - Top of aquifer/initial water table to screen bottom (z2) ...: 7.500000 (length)
## - Inside radius of standpipe where levels change (rp) ........: 1.500000 (length)
## - Length of screened interval (xll) ..........................: 5.700000 (length)
## - Predefined Times (t)/drawdown measurements (dd):
##         t   dd
## 1     600 0.04
## 2    1200 0.04
## 3    1800 0.06
## 4    2400 0.06
## 5    3600 0.07
## 6    5400 0.09
## 7    7200 0.10
## 8   10800 0.11
## 9   15000 0.13
## 10  21600 0.15
## 11  31200 0.16
## 12  44400 0.18
## 13  63600 0.20
## 14  90600 0.21
## 15 129600 0.23
## 
## Observation Well "OW1"
## - Type: Partially penetrating observation well (iows = 0)
## - Delayed response: yes (idpr = 1)
## - Radial dist. from axis of pumped well to obs. well (r) .....: 309.500000 (length)
## - Top of aquifer/initial water table to screen top (z1) ......: 1.800000 (length)
## - Top of aquifer/initial water table to screen bottom (z2) ...: 7.500000 (length)
## - Inside radius of standpipe where levels change (rp) ........: 1.500000 (length)
## - Length of screened interval (xll) ..........................: 5.700000 (length)
## - Predefined Times (t)/drawdown measurements (dd):
##         t   dd
## 1     600 0.00
## 2    1200 0.00
## 3    1800 0.00
## 4    2400 0.01
## 5    3600 0.01
## 6    5400 0.01
## 7    7200 0.02
## 8   10800 0.03
## 9   15000 0.03
## 10  21600 0.04
## 11  31200 0.05
## 12  44400 0.06
## 13  63600 0.07
## 14  90600 0.08
## 15 129600 0.09</code></pre>
<p>and also graphically visualised with the function <code><a href="../reference/wtPlotConfiguration.html">wtPlotConfiguration()</a></code>, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wtPlotConfiguration.html">wtPlotConfiguration</a></span>(wtaqConfiguration, <span class="dt">asp =</span> <span class="ot">NA</span>)</code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div id="model-run" class="section level3">
<h3 class="hasAnchor">
<a href="#model-run" class="anchor"></a>Model run</h3>
<p>For running WTAQ and saving the results in the R object <code>result</code> we just have do use the function <code><a href="../reference/wtRunConfiguration.html">wtRunConfiguration()</a></code> with our above defined model parameterisation <code>wtaqConfiguration</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span>(wtaqConfiguration)</code></pre></div>
</div>
<div id="analysing-results" class="section level3">
<h3 class="hasAnchor">
<a href="#analysing-results" class="anchor"></a>Analysing results</h3>
<p>To print the results of the model run, that are stored in the object <code>result</code> in the <strong>RStudio</strong> console we simply need to enter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result</code></pre></div>
<pre><code>##    WELL   TIME MEASDD    CALCDD  RELERR
## 3    PW    600   0.73 3.808e+00 -421.60
## 4    PW   1200   0.74 4.731e+00 -539.40
## 5    PW   1800   0.75 5.033e+00 -571.00
## 6    PW   2400   0.77 5.189e+00 -573.90
## 7    PW   3600   0.78 5.402e+00 -592.50
## 8    PW   5400   0.80 5.640e+00 -604.90
## 9    PW   7200   0.82 5.825e+00 -610.30
## 10   PW  10800   0.83 6.103e+00 -635.30
## 11   PW  15000   0.85 6.338e+00 -645.60
## 12   PW  21600   0.87 6.602e+00 -658.90
## 13   PW  31200   0.89 6.869e+00 -671.80
## 14   PW  44400   0.92 7.123e+00 -674.30
## 15   PW  63600   0.93 7.380e+00 -693.60
## 16   PW  90600   0.95 7.631e+00 -703.20
## 17   PW 129600   0.96 7.883e+00 -721.10
## 20  OW4    600   0.04 2.162e-02   45.94
## 21  OW4   1200   0.04 4.856e-02  -21.41
## 22  OW4   1800   0.06 6.812e-02  -13.53
## 23  OW4   2400   0.06 8.315e-02  -38.59
## 24  OW4   3600   0.07 1.086e-01  -55.15
## 25  OW4   5400   0.09 1.453e-01  -61.41
## 26  OW4   7200   0.10 1.826e-01  -82.61
## 27  OW4  10800   0.11 2.579e-01 -134.50
## 28  OW4  15000   0.13 3.440e-01 -164.60
## 29  OW4  21600   0.15 4.703e-01 -213.50
## 30  OW4  31200   0.16 6.307e-01 -294.20
## 31  OW4  44400   0.18 8.115e-01 -350.90
## 32  OW4  63600   0.20 1.016e+00 -408.10
## 33  OW4  90600   0.21 1.232e+00 -486.60
## 34  OW4 129600   0.23 1.460e+00 -534.60
## 37  OW1    600   0.00 1.659e-05      NA
## 38  OW1   1200   0.00 4.502e-05      NA
## 39  OW1   1800   0.00 7.374e-05      NA
## 40  OW1   2400   0.01 1.039e-04   98.96
## 41  OW1   3600   0.01 1.747e-04   98.25
## 42  OW1   5400   0.01 3.169e-04   96.83
## 43  OW1   7200   0.02 5.106e-04   97.45
## 44  OW1  10800   0.03 1.081e-03   96.40
## 45  OW1  15000   0.03 2.114e-03   92.95
## 46  OW1  21600   0.04 4.682e-03   88.30
## 47  OW1  31200   0.05 1.075e-02   78.49
## 48  OW1  44400   0.06 2.373e-02   60.45
## 49  OW1  63600   0.07 5.076e-02   27.49
## 50  OW1  90600   0.08 9.924e-02  -24.05
## 51  OW1 129600   0.09 1.775e-01  -97.28</code></pre>
<p>For plotting the results we can either use the function <code><a href="../reference/wtPlotResult.html">wtPlotResult()</a></code> with the parameter <code>plottype = "w"</code> to plot for each well measured (MEASDD) and calculated (CALCDD) drawdowns in one plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span>(result, 
             <span class="dt">plottype =</span> <span class="st">"w"</span>, 
             <span class="dt">main=</span><span class="st">"Pumping test W5: model results without calibration"</span>)</code></pre></div>
<pre><code>## Removing column 'RELERR' from 'wtaqResult'.</code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>or produce a plot that contains measured and calculated drawdowns for all wells in two separate plots by setting the parameter <code>plottype = "s"</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span>(result, 
             <span class="dt">plottype =</span> <span class="st">"s"</span>,
             <span class="dt">main=</span><span class="st">"Pumping test W5: model results without calibration"</span>)</code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div id="model-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#model-calibration" class="anchor"></a>Model calibration</h3>
<p>For this tutorial calibration is realised by using an automatised one-dimensional optimisation approach for the following two model parameters, because these were identified to be the most sensitive ones:</p>
<ul>
<li><p><a href="#aquifer-characteristics-horizontal-hydraulic-conductivity-step-1">1. Step: Horizontal hydraulic aquifer conductivity (hkr): for calibrating the drawdown in the observation well</a></p></li>
<li><p><a href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2">2. Step: Well-skin parameter: for calibrating production well drawdown</a></p></li>
</ul>
<p>The approach is valid because the calibration of the well-skin parameter (during Step 2) has no impact on the observation well drawdowns (Step 1). However, it needs to be stated that conditions could occur, where a better model fit could be possible (especially if the mid-term drawdown data are not fitting well) in case that both, vertical <code>hkz</code> and horizontal <code>hkr</code> hydraulic aquifer conductivity are varied in tandem.</p>
<p>Within this tutorial we solve this one-dimensional optimisation problem by using:</p>
<ul>
<li><p>the build-in R function <code>optimise()</code> and</p></li>
<li><p>the Root-Mean-Square-Error (RMSE) as the only performance criteria for evaluating the model fitness (i.e. comparision of calculated and measured drawdowns).</p></li>
</ul>
<p>For solving this optimisation (or: calibration) problem we define the R function <code>calibrateModel()</code> which requires the following four input parameters:</p>
<ul>
<li><p><code>configuration</code>: a valid WTAQ input parameterisation (here: <code>wtaqConfiguration</code>)</p></li>
<li><p><code>wellPattern</code>: a regular expression or the well(s) names to be used for the model fit evaluation (here: <code>OW4</code> or <code>PW</code>)</p></li>
<li><p><code>parameterName</code>: name of the WTAQ parameter that should be calibrated (here: <code>hkr</code> or <code>sw</code>)</p></li>
<li><p><code>parameterRange</code>: allowed value range for calibration parameter (e.g. <code>c(0.0001, 0.1)</code> for parameter <code>hkr</code>)</p></li>
</ul>
<p>Firstly this function - and its three dependent helper functions <code><a href="../reference/modelFitness.html">modelFitness()</a></code>, <code>modelFitnessAggregated</code> and <code>fitnessAdaptedModelConfiguration()</code> - need to be loaded in R by running the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Package for gof function
<span class="kw">library</span>(hydroGOF)</code></pre></div>
<pre><code>## Lade nötiges Paket: zoo</code></pre>
<pre><code>## 
## Attache Paket: 'zoo'</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># modelFitness(): called by function modelFitnessAggregated()</span>
modelFitness &lt;-<span class="st"> </span><span class="cf">function</span>
(
  wtaqResult, 
  wellPattern
  )
  {
  subResult &lt;-<span class="st"> </span>wtaqResult[<span class="kw">grep</span>(<span class="dt">pattern =</span> wellPattern, wtaqResult<span class="op">$</span>WELL),]
  
  
  fitness &lt;-<span class="st"> </span><span class="kw">t</span>(hydroGOF<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/hydroGOF/topics/gof">gof</a></span>(<span class="dt">sim =</span> subResult<span class="op">$</span>MEASDD, <span class="dt">obs =</span> subResult<span class="op">$</span>CALCDD, <span class="dt">digits =</span> <span class="dv">3</span>))
  
  <span class="kw">colnames</span>(fitness) &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">" %"</span>, <span class="st">""</span>, <span class="kw">colnames</span>(fitness))
  
  ### data.frame with plenty of performance indicators: e.g. RMSE, NSE, R2
  <span class="kw">as.data.frame</span>(fitness)
  }

<span class="co"># modelFitnessAggregated: called by function fitnessAdaptedModelConfiguration()</span>
modelFitnessAggregated &lt;-<span class="st"> </span><span class="cf">function</span> 
(
  wtaqResult, 
  wellPattern
  )
  {
  fitness &lt;-<span class="st"> </span><span class="kw"><a href="../reference/modelFitness.html">modelFitness</a></span>(wtaqResult, wellPattern)
  
  ### Objective function for the performance criteria that is minimised, here:
  fitness<span class="op">$</span>RMSE 
  }

<span class="co"># fitnessAdaptedModelConfiguration: called by function calibrateModel()</span>
fitnessAdaptedModelConfiguration &lt;-<span class="st"> </span><span class="cf">function</span> 
(
  parameterValue, parameterName, configuration, wellPattern 
  ) 
  {
  configuration &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtSetParameter.html">wtSetParameter</a></span>(configuration, parameterName, parameterValue)
  
  wtaqResult &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span>(configuration)
  
  <span class="kw"><a href="../reference/modelFitnessAggregated.html">modelFitnessAggregated</a></span>(wtaqResult, wellPattern)
  }

<span class="co">#calibrateModel()</span>
calibrateModel &lt;-<span class="st"> </span><span class="cf">function</span> (
    ### WTAQ parameterisation, e.g. as retrieved by wtConfigure()
    configuration,
    ### regular expression or name of well(s) to be used for calibration: e.g. "OW4"
    wellPattern,
    ### name of ONE WTAQ parameter to be calibrated: e.g. `hkr`, `sw`
    parameterName,
    ### min/max range of possible calibration parameter values 
    parameterRange 
    ) 
    {
    optResults &lt;-<span class="st"> </span><span class="kw">optimise</span>(
      <span class="dt">f =</span> fitnessAdaptedModelConfiguration, 
      <span class="dt">interval =</span> parameterRange,
      <span class="dt">parameterName =</span> parameterName, 
      <span class="dt">configuration =</span> configuration, 
      <span class="dt">wellPattern =</span> wellPattern )
    
    ### Save calibrated WTAQ configuration: 
    wtaqConfigurationCalibrated &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wtSetParameter.html">wtSetParameter</a></span>(
      <span class="dt">configuration =</span> configuration, 
      <span class="dt">parameterName =</span> parameterName, 
      <span class="dt">parameterValue =</span> optResults<span class="op">$</span>minimum)
    
    ### Save optimisation results in list
    <span class="kw">list</span>(<span class="dt">parameterName=</span>parameterName, 
         <span class="dt">wellPattern=</span>wellPattern,
         <span class="dt">optimalParameterValue=</span>optResults<span class="op">$</span>minimum, 
         <span class="dt">minimalPerformanceValue=</span>optResults<span class="op">$</span>objective,
         <span class="dt">wtaqConfig=</span>wtaqConfigurationCalibrated
         )
    
    }</code></pre></div>
<div id="aquifer-characteristics-horizontal-hydraulic-conductivity-step-1" class="section level4">
<h4 class="hasAnchor">
<a href="#aquifer-characteristics-horizontal-hydraulic-conductivity-step-1" class="anchor"></a>Aquifer characteristics: horizontal hydraulic conductivity (Step 1)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1.Step: Calibrate aquifer characteristics 'hkr' for OW4-------------------------------</span>

calibratedAquifer &lt;-<span class="st"> </span><span class="kw">calibrateModel</span>(
  ### reference wtaq configuration
  <span class="dt">configuration =</span> wtaqConfiguration, 
  ### calibrate hydraulic aquifer conductivity
  <span class="dt">parameterName =</span> <span class="st">"hkr"</span>,  
  ### 'hkr' is within 0.0001 - 0.1 m/s
  <span class="dt">parameterRange =</span> <span class="kw">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.1</span>), 
  ### only use drawdown time-series of OW4 for calibration 
  <span class="dt">wellPattern =</span> <span class="st">"OW4"</span> 
  )


### Plot the drawdowns with calibrated aquifer characteristics:
<span class="kw"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span>(<span class="dt">wtaqResult =</span> <span class="kw"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span>(
  <span class="dt">configuration =</span> calibratedAquifer<span class="op">$</span>wtaqConfig),
  
  <span class="dt">main =</span> <span class="kw">sprintf</span>(<span class="st">"Optimal value of parameter '%s' for %s: %0.4f m/s"</span>, 
                 calibratedAquifer<span class="op">$</span>parameterName, 
                 calibratedAquifer<span class="op">$</span>wellPattern, 
                 calibratedAquifer<span class="op">$</span>optimalParameterValue),
  <span class="dt">plottype =</span> <span class="st">"w"</span>)</code></pre></div>
<pre><code>## Removing column 'RELERR' from 'wtaqResult'.</code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-26-1.png" width="700"> After this step observed and measured drawdowns fit nearly perfectly for the calibrated observation well “OW4” only by setting the <strong>hkr</strong> to <strong>0.0148366</strong> (m/s) , but still the drawdown in the production well “PW” is underestimated (because it is still assumed that here are no “well losses”).</p>
<p>Thus the production well characteristics (i.e. the well-skin parameter <code>sw</code>) need to be calibrated in a next step.</p>
</div>
<div id="well-characteristics-well-bore-skin-parameter-of-production-well-step-2" class="section level4">
<h4 class="hasAnchor">
<a href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2" class="anchor"></a>Well characteristics: well-bore skin parameter of production well (Step 2)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#2.Step: Calibrate well-bore skin parameter 'sw' for PW-------------------------------</span>
calibratedAquiferAndWellSkin &lt;-<span class="st"> </span><span class="kw">calibrateModel</span>(
  #### WTAQ configuration with calibrated aquifer (Step1)
  <span class="dt">configuration =</span> calibratedAquifer<span class="op">$</span>wtaqConfig,
  ### calibrate well-bore skin parameter
  <span class="dt">parameterName =</span> <span class="st">"sw"</span>, 
  ### 'sw' within 0 - 100 (dimensionless)
  <span class="dt">parameterRange =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), 
  ### only use drawdown time-series of PW for calibration 
  <span class="dt">wellPattern =</span> <span class="st">"PW"</span>  
  )

### Plot the drawdowns with calibrated aquifer &amp; well-bore skin characteristics:
<span class="kw"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span>(<span class="dt">wtaqResult =</span> <span class="kw"><a href="../reference/wtRunConfiguration.html">wtRunConfiguration</a></span>(
  <span class="dt">configuration =</span> calibratedAquiferAndWellSkin<span class="op">$</span>wtaqConfig,
  ),
  
  <span class="dt">main =</span> <span class="kw">sprintf</span>(<span class="st">"Optimal value of parameter '%s' for %s: %2.4f (dimensionless)"</span>, 
                 calibratedAquiferAndWellSkin<span class="op">$</span>parameterName, 
                 calibratedAquiferAndWellSkin<span class="op">$</span>wellPattern, 
                 calibratedAquiferAndWellSkin<span class="op">$</span>optimalParameterValue),
  <span class="dt">plottype =</span> <span class="st">"w"</span>)</code></pre></div>
<pre><code>## Removing column 'RELERR' from 'wtaqResult'.</code></pre>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>By calibrating the well-skin parameter <strong>sw</strong> to <strong>2.0150393</strong> the drawdown in the production well “PW” now also fits nearly perfectly the observed drawdown values, without impacting the fit for the observation wells.</p>
<p><strong>Note:</strong> <em>There might be cases where the calibration results by following the methodology defined above is not satisfying. This can be possibly solved by calibrating multiple parameters in parallel (e.g. horizontal <code>hkr</code> and vertical hydraulic aquifer conductivity <code>hkz</code>). For this a more complex algorithm (e.g. build-in R function <code>optim()</code>), which is able to solve multi-dimenional optimisation problems, might be usefull. However, this goes beyond the scope of this tutorial.</em></p>
</div>
</div>
</div>
<div id="level-2-multiple-pumping-wells" class="section level2">
<h2 class="hasAnchor">
<a href="#level-2-multiple-pumping-wells" class="anchor"></a>Level 2: Multiple pumping wells</h2>
<p><strong>Note:</strong> <em>For performing this example session it is required to perform all steps of the <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example session first, because this example session requires some data of the <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example</em></p>
<p>One challenge of using WTAQ for multiple wells is that the drawdown simulation for each model run is limited to:</p>
<ul>
<li><p>one active production well and</p></li>
<li><p>up to 25 observation wells</p></li>
</ul>
<p>This means that the model parameterisation for the pumping (e.g. pumping rate) and observation wells (e.g. distance to pumping well) needs to be adapted for each model run manually by using the <strong>Level 1</strong> function (see: <a href="#level-1-one-pumping-well">Level 1: one pumping well</a> example).</p>
<p>For avoiding such time consuming task additional <strong>Level 2</strong> functions were developed and included in the <em>kwb.wtaq</em> package that simplify using WTAQ on the well-field scale. The usage of these functions is described in the following:</p>
<div id="model-parameterisation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#model-parameterisation-1" class="anchor"></a>Model parameterisation</h3>
<div id="well-field" class="section level4">
<h4 class="hasAnchor">
<a href="#well-field" class="anchor"></a>Well field</h4>
<p>In a first step the well field is defined, by creating a R object <code>owWellfieldConf</code> that contains the following properties for each well, i.e.:</p>
<ul>
<li><p>Location <code>x</code>, <code>y</code>,</p></li>
<li><p>Well diameter <code>r</code>,</p></li>
<li><p>Depth of filter screen top <code>z1</code> and bottom <code>z2</code> below initial groundwater level</p></li>
<li><p>Well-skin parameter <code>sw</code></p></li>
</ul>
<p>For <strong>all</strong> production wells the well-skin parameter <code>sw</code> is set to <code>wellSkin</code>, because this value achieved the best-model fit during <a href="#well-characteristics-well-bore-skin-parameter-of-production-well-step-2">calibration for W5</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Well-skin parameter from calibration of W5 for all wells of the well field 
wellSkin &lt;-<span class="st"> </span>calibratedAquiferAndWellSkin<span class="op">$</span>optimalParameterValue
<span class="kw">sprintf</span>(<span class="st">"Well-skin parameter value: %2.6f (dimensionless)"</span>, wellSkin)</code></pre></div>
<pre><code>## [1] "Well-skin parameter value: 2.015039 (dimensionless)"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example well field configuration with 5 wells</span>
owWellfieldConf &lt;-<span class="st"> </span><span class="kw">rbind</span>(  
  
  <span class="kw"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span>(
    <span class="dt">wellName =</span> <span class="st">"W1"</span>, <span class="dt">x =</span> <span class="fl">807679.64</span>, <span class="dt">y =</span> <span class="fl">2091015.29</span>, 
    <span class="dt">r =</span> <span class="fl">1.5</span>, <span class="dt">z1 =</span> <span class="dv">2</span>, <span class="dt">z2 =</span> <span class="dv">4</span>, <span class="dt">sw =</span> wellSkin),  
  
  <span class="kw"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span>(
    <span class="dt">wellName =</span> <span class="st">"W2"</span>, <span class="dt">x =</span> <span class="fl">807608.66</span>, <span class="dt">y =</span> <span class="fl">2091018.51</span>, 
    <span class="dt">r =</span> <span class="fl">1.7</span>, <span class="dt">z1 =</span> <span class="fl">4.2</span>, <span class="dt">z2 =</span> <span class="dv">7</span>, <span class="dt">sw =</span> wellSkin),
  
  <span class="kw"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span>(
    <span class="dt">wellName =</span> <span class="st">"W3"</span>, <span class="dt">x =</span> <span class="fl">807558.27</span>, <span class="dt">y =</span> <span class="fl">2091090.30</span>, 
    <span class="dt">r =</span> <span class="fl">1.5</span>, <span class="dt">z1 =</span> <span class="fl">1.8</span>, <span class="dt">z2 =</span> <span class="dv">8</span>, <span class="dt">sw =</span> wellSkin),
  
  <span class="kw"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span>(
    <span class="dt">wellName =</span> <span class="st">"W4"</span>, <span class="dt">x =</span> <span class="fl">807509.29</span>, <span class="dt">y =</span>  <span class="fl">2091161.80</span>, 
    <span class="dt">r =</span> <span class="fl">1.5</span>, <span class="dt">z1 =</span> <span class="fl">1.8</span>, <span class="dt">z2 =</span> <span class="fl">7.5</span>, <span class="dt">sw =</span> wellSkin),
  
  <span class="kw"><a href="../reference/owConfigureWell.html">owConfigureWell</a></span>(
    <span class="dt">wellName =</span> <span class="st">"W5"</span>, <span class="dt">x =</span> <span class="fl">807458.95</span>, <span class="dt">y =</span>  <span class="fl">2091232.26</span>, 
    <span class="dt">r =</span> <span class="fl">1.5</span>, <span class="dt">z1 =</span> <span class="fl">0.4</span>, <span class="dt">z2 =</span> <span class="fl">7.8</span>, <span class="dt">sw =</span> wellSkin))</code></pre></div>
<p><strong>Note:</strong><br><em>On the <strong>Level 2</strong> function level it is now not necessary to define well distances (this was required in the <a href="#model-parameterisation">Level 1: one pumping well example</a>. The well distances will be set later automatically for each model run based on both, the <code>x</code> <code>y</code> coordinates:</em></p>
<pre><code>## Well distance matrix table:</code></pre>
<pre><code>##       W1    W2    W3    W4    W5
## W1        71.1 142.7 224.7 309.5
## W2  71.1        87.7 174.4 261.0
## W3 142.7  87.7        86.7 173.3
## W4 224.7 174.4  86.7        86.6
## W5 309.5 261.0 173.3  86.6</code></pre>
<p><em>and on the information which well is operating. For example column “W2” is used if the pumping Well is “W2”</em></p>
</div>
<div id="basic-model-parameterisation" class="section level4">
<h4 class="hasAnchor">
<a href="#basic-model-parameterisation" class="anchor"></a>Basic model parameterisation</h4>
<p>In a next step we define we use the <strong>Level 2</strong> function <code><a href="../reference/owConfigure.html">owConfigure()</a></code> to prepare the constant parts of the WTAQ configuration parameterisation (<code>wellfield</code>, <code>aquifer</code> and <code>drainage</code>) and store them in the object <code>owConf</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create constant components of WTAQ configuration</span>
owConf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/owConfigure.html">owConfigure</a></span>(<span class="dt">wellfield =</span> owWellfieldConf,
                      <span class="dt">aquifer =</span> calibratedAquiferAndWellSkin<span class="op">$</span>wtaqConfig<span class="op">$</span>aquifer,
                      <span class="dt">drainage =</span> <span class="kw"><a href="../reference/wtConfigureDrainage.html">wtConfigureDrainage</a></span>(<span class="dt">idra =</span> <span class="dv">0</span>)
                     )</code></pre></div>
<p><strong>Note:</strong> <em>For the parameter <code>aquifer</code> we simply use the calibrated parameter setting, that we obtained after the <a href="#model-calibration">Level 1 model calibration</a>, which is stored in the R object:</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calibratedAquiferAndWellSkin<span class="op">$</span>wtaqConfig<span class="op">$</span>aquifer</code></pre></div>
<pre><code>## $aqtype
## [1] "WATER TABLE"
## 
## $bb
## [1] 10
## 
## $hkr
## [1] 0.01483664
## 
## $hkz
## [1] 3.5e-05
## 
## $ss
## [1] 1e-05
## 
## $sy
## [1] 0.05</code></pre>
<p>The well field configuration can be plotted with the function <code><a href="../reference/owPlotConfiguration.html">owPlotConfiguration()</a></code> (top view &amp; side view). By setting the parameter <code>referenceWell=1</code> the Well 1 is selected as reference well for plotting:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/owPlotConfiguration.html">owPlotConfiguration</a></span>(owConf,  <span class="dt">referenceWell =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-32-1.png" width="960"></p>
</div>
<div id="time-varying-model-parameteristion" class="section level4">
<h4 class="hasAnchor">
<a href="#time-varying-model-parameteristion" class="anchor"></a>Time-varying model parameteristion</h4>
<p>The time-variant model parameterisation contains:</p>
<ul>
<li><p>the pumping rates (<code>pumpingRates</code>) of each well (here: defined in <code>owWellfieldConf</code>) and</p></li>
<li><p>the times for which the drawdowns should be calculated (<code>timesForDDcalculation</code>)</p></li>
</ul>
<p>These are defined in the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pumping rates of well W1 to W5</span>
pumpingRates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.069</span>, <span class="fl">0.089</span>, <span class="fl">0.088</span>, <span class="fl">0.087</span>, <span class="fl">0.086</span>) 

### user-specified times
timesForDDcalculation &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">600</span>,<span class="dv">1200</span>, <span class="dv">2400</span>,<span class="dv">3600</span>, 
                           <span class="dv">10000</span>, <span class="dv">50000</span>, <span class="dv">100000</span>, <span class="dv">300000</span>) </code></pre></div>
</div>
</div>
<div id="model-run-1" class="section level3">
<h3 class="hasAnchor">
<a href="#model-run-1" class="anchor"></a>Model run</h3>
<p>Now we have all parts for parameterising WTAQ and calulating the drawdowns easily on the well field scale (i.e. running WTAQ multiple times in the background).</p>
<p>For this we use the function <code><a href="../reference/owGetDrawdowns.html">owGetDrawdowns()</a></code> with the following parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ddlist &lt;-<span class="st"> </span><span class="kw"><a href="../reference/owGetDrawdowns.html">owGetDrawdowns</a></span>(
  <span class="dt">owConf=</span>owConf, 
  <span class="dt">Q =</span> pumpingRates, 
  <span class="dt">times =</span> timesForDDcalculation,
  ### required for using the function wtPlotResults()
  <span class="dt">to.matrix=</span><span class="ot">FALSE</span> 
  )

ddmatrix&lt;-<span class="st"> </span><span class="kw"><a href="../reference/owGetDrawdowns.html">owGetDrawdowns</a></span>(
  <span class="dt">owConf=</span>owConf, 
  <span class="dt">Q =</span> pumpingRates, 
  <span class="dt">times =</span> timesForDDcalculation,
  ### saves results in "matrix" format: required for function owSuperposeDrawdowns()
  <span class="dt">to.matrix=</span><span class="ot">TRUE</span> 
  )</code></pre></div>
<p>The switch <code>to.matrix=TRUE</code> is required in case one would like to calculate the total drawdown in each well including well interference with the function <code><a href="../reference/owSuperposeDrawdowns.html">owSuperposeDrawdowns()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">drawdownsWithWellInterference &lt;-<span class="st"> </span><span class="kw"><a href="../reference/owSuperposeDrawdowns.html">owSuperposeDrawdowns</a></span>(<span class="dt">drawdownList =</span> ddmatrix)</code></pre></div>
</div>
<div id="analysing-results-1" class="section level3">
<h3 class="hasAnchor">
<a href="#analysing-results-1" class="anchor"></a>Analysing results</h3>
<p><strong>Quantifying the impact of well interference</strong></p>
<p>Finally the modelling results can be analysed. For example it is possible to quantify the additional drawdown due to well interference, e.g. for “W1”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myWell &lt;-<span class="st"> "W1"</span>
DD_inProductionWell_withInterference &lt;-<span class="st"> </span>drawdownsWithWellInterference[,myWell] 
DD_inProductionWell_withoutInterference &lt;-<span class="st"> </span>ddmatrix[[myWell]][,myWell]
diffDrawdown &lt;-<span class="st"> </span>DD_inProductionWell_withInterference<span class="op">-</span>DD_inProductionWell_withoutInterference
<span class="kw">data.frame</span>(<span class="dt">time.in.seconds=</span>drawdownsWithWellInterference[,<span class="dv">1</span>],
      <span class="dt">additionalDrawdown.due.to.wellInterference.in.meter=</span>diffDrawdown)</code></pre></div>
<pre><code>##    time.in.seconds additionalDrawdown.due.to.wellInterference.in.meter
## 1                1                                         0.000000000
## 2                5                                         0.000016160
## 3               10                                         0.000116362
## 4               30                                         0.001717690
## 5               60                                         0.007218800
## 6              600                                         0.101305000
## 7             1200                                         0.119617000
## 8             2400                                         0.140303000
## 9             3600                                         0.159315000
## 10           10000                                         0.242770000
## 11           50000                                         0.483100000
## 12          100000                                         0.607290000
## 13          300000                                         0.810100000</code></pre>
<p><strong>Plotting of well drawdowns (without well interference):</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (wellName <span class="cf">in</span> owWellfieldConf<span class="op">$</span>wellName)
{
  index &lt;-<span class="st"> </span><span class="kw">which</span>(owWellfieldConf<span class="op">$</span>wellName<span class="op">==</span>wellName)
 wellQ &lt;-<span class="st"> </span>pumpingRates[index]
 <span class="cf">if</span> (wellQ <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
 {
  <span class="kw"><a href="../reference/wtPlotResult.html">wtPlotResult</a></span>(<span class="dt">wtaqResult =</span> ddlist[[wellName]], 
               <span class="dt">plottype =</span> <span class="st">"s"</span>, 
               <span class="dt">ylab =</span> <span class="st">"Drawdown (m)"</span>,
               <span class="dt">xlab =</span> <span class="st">"Time in seconds since start of pumping (s)"</span>,
               <span class="dt">main =</span> <span class="kw">sprintf</span>(<span class="st">"Pumping well: %s (Q: %3.1f m3/h)"</span>, 
                              wellName,                                   
                              wellQ<span class="op">*</span><span class="dv">3600</span>))
 }
}</code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-1.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-2.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-3.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-4.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-37-5.png" width="700"></p>
<p><strong>Plotting of well drawdowns (with well interference):</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotWellInterference &lt;-<span class="st"> </span><span class="cf">function</span>(wellName, <span class="dt">Q=</span><span class="ot">NULL</span>)
{
  <span class="cf">if</span> (<span class="kw">is.null</span>(Q)) {
    label &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">"%s "</span>,wellName)
    } <span class="cf">else</span> {
      label &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">"%s (%3.1f m3/h) "</span>,wellName, Q<span class="op">*</span><span class="dv">3600</span>)
    }
  
  drawdown &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SCENARIO=</span><span class="st">"no well interference"</span>, 
                         <span class="dt">TIME=</span>ddmatrix[[wellName]][,<span class="st">"TIME"</span>], 
                         <span class="dt">CALCDD=</span>ddmatrix[[wellName]][,wellName])
  drawdownWithInterference &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">"SCENARIO"</span>=<span class="st">"with well interference"</span>, 
                         <span class="dt">TIME=</span>drawdownsWithWellInterference[,<span class="st">"TIME"</span>], 
                         <span class="dt">CALCDD=</span>drawdownsWithWellInterference[,wellName])
  
  res &lt;-<span class="st"> </span><span class="kw">rbind</span>(drawdown, drawdownWithInterference)
  <span class="kw">print</span>(lattice<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/lattice/topics/xyplot">xyplot</a></span>(CALCDD <span class="op">~</span><span class="st"> </span>TIME, 
                        <span class="dt">groups =</span>  SCENARIO, 
                        <span class="dt">ylim=</span><span class="kw">rev</span>(<span class="kw">extendrange</span>(res<span class="op">$</span>CALCDD)),
                        <span class="dt">ylab =</span> <span class="st">"Drawdown (m)"</span>,
                        <span class="dt">xlab =</span> <span class="st">"Time in seconds since start of pumping (s)"</span>,
                        <span class="dt">type=</span><span class="st">"b"</span>, 
                        <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">columns=</span><span class="dv">2</span>), 
                        <span class="dt">data=</span>res, 
                        <span class="dt">main =</span> label))
}

<span class="cf">for</span> (wellName <span class="cf">in</span> owWellfieldConf<span class="op">$</span>wellName)
{
  index &lt;-<span class="st"> </span><span class="kw">which</span>(owWellfieldConf<span class="op">$</span>wellName<span class="op">==</span>wellName)
 wellQ &lt;-<span class="st"> </span>pumpingRates[index]
 <span class="kw">plotWellInterference</span>(<span class="dt">wellName =</span> wellName, <span class="dt">Q =</span> wellQ)
}</code></pre></div>
<p><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-1.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-2.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-3.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-4.png" width="700"><img src="kwbwtaq_Tutorial_files/figure-html/unnamed-chunk-38-5.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#preparation">Preparation</a></li>
      <li><a href="#using-the-package-help">Using the package help</a></li>
      </ul>
</li>
      <li>
<a href="#example-sessions">Example sessions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#level-1-one-pumping-well">Level 1: One pumping well</a></li>
      <li><a href="#level-2-multiple-pumping-wells">Level 2: Multiple pumping wells</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
