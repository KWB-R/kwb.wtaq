<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Tutorial for R package kwb.wtaq</title>
  <meta name="description" content="This is a tutorial of using the kwb.wtaq package">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Tutorial for R package kwb.wtaq" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial of using the kwb.wtaq package" />
  <meta name="github-repo" content="KWB-R/kwb.wtaq" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tutorial for R package kwb.wtaq" />
  
  <meta name="twitter:description" content="This is a tutorial of using the kwb.wtaq package" />
  

<meta name="author" content="Hauke Sonnenberg &amp; Michael Rustler (Kompetenzzentrum Wasser Berlin gGmbH)">


<meta name="date" content="2018-07-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="example-sessions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WTAQ tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#objective"><i class="fa fa-check"></i><b>2.2</b> Objective</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#preparation"><i class="fa fa-check"></i><b>2.3</b> Preparation</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#installation-of-required-r-packages"><i class="fa fa-check"></i><b>2.3.1</b> Installation of required R packages</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#loading-the-package"><i class="fa fa-check"></i><b>2.3.2</b> Loading the package</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#using-the-package-help"><i class="fa fa-check"></i><b>2.4</b> Using the package help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-sessions.html"><a href="example-sessions.html"><i class="fa fa-check"></i><b>3</b> Example sessions</a><ul>
<li class="chapter" data-level="3.1" data-path="example-sessions.html"><a href="example-sessions.html#level-1-one-pumping-well"><i class="fa fa-check"></i><b>3.1</b> Level 1: One pumping well</a><ul>
<li class="chapter" data-level="3.1.1" data-path="example-sessions.html"><a href="example-sessions.html#pumping-test-data"><i class="fa fa-check"></i><b>3.1.1</b> Pumping test data</a></li>
<li class="chapter" data-level="3.1.2" data-path="example-sessions.html"><a href="example-sessions.html#model-parameterisation"><i class="fa fa-check"></i><b>3.1.2</b> Model parameterisation</a></li>
<li class="chapter" data-level="3.1.3" data-path="example-sessions.html"><a href="example-sessions.html#model-run"><i class="fa fa-check"></i><b>3.1.3</b> Model run</a></li>
<li class="chapter" data-level="3.1.4" data-path="example-sessions.html"><a href="example-sessions.html#analysing-results"><i class="fa fa-check"></i><b>3.1.4</b> Analysing results</a></li>
<li class="chapter" data-level="3.1.5" data-path="example-sessions.html"><a href="example-sessions.html#model-calibration"><i class="fa fa-check"></i><b>3.1.5</b> Model calibration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="example-sessions.html"><a href="example-sessions.html#level-2-multiple-pumping-wells"><i class="fa fa-check"></i><b>3.2</b> Level 2: Multiple pumping wells</a><ul>
<li class="chapter" data-level="3.2.1" data-path="example-sessions.html"><a href="example-sessions.html#model-parameterisation-1"><i class="fa fa-check"></i><b>3.2.1</b> Model parameterisation</a></li>
<li class="chapter" data-level="3.2.2" data-path="example-sessions.html"><a href="example-sessions.html#model-run-1"><i class="fa fa-check"></i><b>3.2.2</b> Model run</a></li>
<li class="chapter" data-level="3.2.3" data-path="example-sessions.html"><a href="example-sessions.html#analysing-results-1"><i class="fa fa-check"></i><b>3.2.3</b> Analysing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>4</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/KWB-R" target="blank">Published by KWB</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorial for R package kwb.wtaq</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction</h1>
<div id="background" class="section level2">
<h2><span class="header-section-number">2.1</span> Background</h2>
<p>Within the OPTIWELLS-2 project, sponsored by Veolia Water, a detailed study was
performed for screening available models that:</p>
<ul>
<li><p>are able to simulate time-dependent well drawdown</p></li>
<li><p>also include the additional drawdown in case of well interference and</p></li>
<li><p>are quite easy to parameterise</p></li>
</ul>
<p>The semi-analytical groundwater model WTAQ-2 was chosen, because it fitted best with the
above defined requirements. However, as the model is programmed in FORTRAN it requires
that the user follows the steps that are listed below:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Step: Definition and parameterisation of text input file,</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Step: Execution of the WTAQ-2 model engine in MS DOS command shell</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Step: Saving of model results in a text output file</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Step: Reading and analysing of model outputs</li>
</ol></li>
<li><ol start="5" style="list-style-type: decimal">
<li>Step (in case of well interference): looping through Steps 1-4 for each
active production well and superposition of additional drawdowns due to well interference</li>
</ol></li>
</ul>
<p>For simplifying this process it was decided to build an R package that enables to
perform all these steps and also includes the WTAQ-2 model engine (for more details
see: <a href="https://doi.org/10.13140/RG.2.1.2140.3683">Sonnenberg et al., 2014</a>).
This R package <em>kwb.wtaq</em> was developed by Hauke Sonnenberg at Kompetenzzentrum
Wasser Berlin (KWB). It provides an Application Programming Interface (API) to the analytical
groundwater drawdown model WTAQ-2, developed by the
United States Geological Survey (USGS) and provided for free (for further
information on WTAQ-2 see: <a href="http://water.usgs.gov/ogw/wtaq/" class="uri">http://water.usgs.gov/ogw/wtaq/</a>).
In the following we will simply use “WTAQ” when referring to the software
WTAQ-2.</p>
</div>
<div id="objective" class="section level2">
<h2><span class="header-section-number">2.2</span> Objective</h2>
<p>The objective of this tutorial is to demonstrate how the functions from the
R-package <em>kwb.wtaq</em> can be used to configure and run a WTAQ model setup and to
read the resulting groundwater drawdowns from the output files that are generated by
the WTAQ model software.</p>
</div>
<div id="preparation" class="section level2">
<h2><span class="header-section-number">2.3</span> Preparation</h2>
<p>In order to use the R package you need to have the <strong>R programming environment
(in version 3.0 or higher)</strong> installed on your computer. You can download it
for free from <a href="http://cran.rstudio.com/" class="uri">http://cran.rstudio.com/</a>.</p>
<p>As Integrated Programming Interface (IDE) for the R environment we recommend
— and for the purpose of this tutorial require — to use the free software <strong>RStudio</strong>.
You can download RStudio from: <a href="http://www.rstudio.com/products/rstudio/download/" class="uri">http://www.rstudio.com/products/rstudio/download/</a>.</p>
<p>The programming environment R is shipped with a basic set of functions. It can be extended
by so-called packages that contain user-defined functions. We used this packaging
mechanism and provide the access functions to WTAQ in the form of an R package
that we named <em>kwb.wtaq</em>.</p>
<p>Before you can start using the functions provided in the package you need to</p>
<ol style="list-style-type: decimal">
<li><p>Install the package into your R programming environment and</p></li>
<li><p>Load the package into your current R session.</p></li>
</ol>
<div id="installation-of-required-r-packages" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Installation of required R packages</h3>
<p>Since the package <em>kwb.wtaq</em> depends on a number of other packages, not only
<em>kwb.wtaq</em> but also all the packages that it depends on need to be installed.</p>
<p>In order to simplify the package installation run the following code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;devtools&quot;</span>)) { <span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>) }</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="dt">repo =</span> <span class="st">&quot;KWB-R/kwb.wtaq&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This will download and install the package <strong><a href="https://github.com/KWB-R/kwb.wtaq">kwb.wtaq</a></strong> with all required
dependencies, i.e.:</p>
<ul>
<li><p>publicly available packages from the Comprehensive R Archive Network (CRAN) and</p></li>
<li><p>the KWB Github package <a href="https://github.com/KWB-R/kwb.utils">kwb.utils</a></p></li>
</ul>
<p>If the installation succeeds the messages generated should read like these:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## package &#39;zoo&#39; successfully unpacked and MD5 sums checked</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">## package &#39;hydroGOF&#39; successfully unpacked and MD5 sums checked</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">## package &#39;lattice&#39; successfully unpacked and MD5 sums checked</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">## package &#39;plotrix&#39; successfully unpacked and MD5 sums checked</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">## </a>
<a class="sourceLine" id="cb3-6" data-line-number="6">## The downloaded binary packages are in</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">##  C:\Dokumente und Einstellungen\Key Hauke\Lokale Einstellungen\Temp\RtmpctBYMz\downloaded_packages</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">## package &#39;kwb.utils&#39; successfully unpacked and MD5 sums checked</a></code></pre></div>
<p>The installation needs to be done only once. The packages keep installed
until you decide to uninstall them. Uninstalling a package in RStudio can
be done by clicking on the <code>Remove package</code> button right to the
package name on the “Packages” tab.</p>
</div>
<div id="loading-the-package" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Loading the package</h3>
<p>Once you have installed all the requied packages you are almost ready to use
the functions contained in the package <em>kwb.wtaq</em>.</p>
<p>As a last step you need to explicitly load the package into your current R
session by running the following R command:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(kwb.wtaq)</a></code></pre></div>
<p>You will see messages stating the progress of loading not only the package
<em>kwb.wtaq</em> but also of all the packages that it depends on.</p>
<p>You may see warnings that the packages have been built under R in a higher
version compared to the version that you are using:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">## Warning: package &#39;kwb.utils&#39; was built under R version 3.0.3</a></code></pre></div>
<p>Unless you are using R in a version prior to 3.0 these messages do not indicate
a problem and can be ignored.</p>
<p>Please note that the functions provided in the <em>kwb.wtaq</em> package can only be
used when the package is loaded with <code>library(kwb.wtaq)</code> as shown here.
This needs to be done each time you start a new R session or each time you
open RStudio.
If you write an R script that uses the functions from <em>kwb.wtaq</em> then
it would be a good practice to put <code>library(kwb.wtaq)</code> as one of the first
lines of your script.</p>
</div>
</div>
<div id="using-the-package-help" class="section level2">
<h2><span class="header-section-number">2.4</span> Using the package help</h2>
<p>A detailed description of the WTAQ model parameters is available in the <a href="http://pubs.usgs.gov/tm/tm3b9/pdf/tm3-b9_barlow_wtaqv2_report.pdf">WTAQ documentation</a>. However, within ‘RStudio’ is not always necessary to consult this manual, because the parameter description is integrated in the <strong>kwb.wtaq</strong> package help. These information can be accessed by pressing <code>Ctrl</code> and <code>Space</code> simultaneously, if the cursor is located within a function, e.g. <code>wtConfGeneral()</code>:</p>
<div class="figure">
<img src="images/ontheflyhelp.jpg" alt="On the fly help in RStudio" />
<p class="caption">On the fly help in RStudio</p>
</div>
<p>The help file for each R function in <code>RStudio</code> can be accessed by using the R command <code>help(functionname)</code> or using <code>?</code> before the functionname, e.g.:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">?kwb.wtaq<span class="op">::</span>wtConfigure</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">help</span>(kwb.wtaq<span class="op">::</span>wtConfigure)</a></code></pre></div>
<div class="rmdtip">
<p>
<em>Typing <code>kwb.wtaq::</code> before the function name is only needed if you haven’t loaded the package into your R session with <code>library(kwb.wtaq)</code> (see <a href="intro.html#loading-the-package">Loading the package</a>)</em>
</p>
</div>
<p>In addition, we also provide a <a href="kwbwtaq_ParameterTable.html">full description</a>
of all the parameters that are accepted by the configuration functions, which
are descriped later in this tutorial.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-sessions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/KWB-R/kwb.wtaq/edit/master/bookdown/01-intro.Rmd",
"text": "Edit"
},
"download": ["wtaq-tutorial.pdf", "wtaq-tutorial.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
